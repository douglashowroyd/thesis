\chapter{Congruences of the Motzkin monoid}
\label{chap:motzkin}

In Chapter \ref{chap:lattice} we explained a relatively quick way of computing
all of a semigroup's congruences, along with information about how they fit into
their lattice structure.  This was implemented in the Semigroups package
\cite{semigroups}, greatly increasing the size and complexity of semigroups
whose congruence lattices can be found using a computer.

One of the first semigroups towards which this new methodology was directed was
the bipartition monoid $\Prt_n$, whose congruence lattice was not previously
known.  Computing this lattice for the first few values of $n$ showed a lattice
with a relatively simple structure, which did not appear to increase much in
complexity as $n$ grew higher than $3$.  The congruence lattices of various
submonoids of $\Prt_n$ were also computed, and appeared to have a similar
structure.  With the rapidly increasing size of $\Prt_n$ (see Table
\ref{tab:pn-size}) it proved impractical to na\"ively calculate the congruence
lattices beyond $n=4$, but careful study of the lattices for small values of
$n$, along with those lattices computed for various submonoids of $\Prt_n$,
yielded a general classification of the congruence lattice of $\Prt_n$ for
arbitrary $n$, along with a classification of the congruence lattices of various
important submonoids.  This classification is explained and proven in
\cite{ourpaper}, the paper upon which this chapter is based.

In this chapter, we will examine the structure of these congruence lattices,
focusing in particular on the Motzkin monoid $\Mot_n$, which was the present
author's particular focus when contributing to \cite{ourpaper}.  Much of this
content is contained in some form in that paper, and is included in this
thesis by the kind permission of my co-authors.  We will start
with the definition of the Motzkin monoid, then describe some preliminary
theory, then describe the Motzkin monoid's lattice of congruences, and
finally give a brief description of how these ideas can be extended to $\Prt_n$
and its other submonoids.

\section{The Motzkin monoid $\Mot_n$}
\label{sec:motzkin-monoid}
In order to define the Motzkin monoid, we must first define a \textit{planar}
bipartition.

\begin{definition}
  \label{def:planar}
  \index{planar bipartition}
  A bipartition is called \textbf{planar} if it can be represented in diagram
  form with all edges contained inside the rectangle formed by the vertices,
  without any edges crossing.
\end{definition}

\begin{example}
  Let $\alpha = \bipart{c|c|c|c}{2-4}{1,2 &3 &4 &5}{2,5 &1 &\mc2{c}{3,4}}$ and
  $\beta = \bipart{c|c|c|c}{3-4}{2 &5 &1,3 &4}{1 &3,4 &2 &5}$.  As can be seen
  in Figure \ref{fig:planar}, $\alpha$ is planar.  However, $\beta$ cannot be
  drawn inside the rectangle without the upper block $\{1,3\}$ crossing lines
  with the transversal $\{2, 1'\}$---hence, $\beta$ is not planar.
\end{example}

\begin{figure}[h]
  \centering
  $$\alpha = \bipartdiag{\tc12\tv22\bC25 \bc34} \qquad
  \beta = \bipartdiag{\tc13 \tv21 \tv54\bc34}$$
  \caption{A planar and a non-planar bipartition}
  \label{fig:planar}
\end{figure}

We can now define the Motzkin monoid.

\begin{definition}
  \label{def:motzkin}
  \index{Motzkin monoid}
  \nomenclature[Mn]{$\Mot_n$}{Motzkin monoid}
  The \textbf{Motzkin monoid} $\Mot_n$ is the submonoid of $\Prt_n$ consisting
  of all planar bipartitions of degree $n$ in which every block has size $1$ or
  $2$.
\end{definition}

To see that this is indeed a monoid, we should observe that it is closed.  It is
easy to see that the product of two planar bipartitions is also planar, since a
double diagram as in Figure \ref{fig:bipartition-example} would contain no
crossing lines, and therefore would resolve to a product with no crossing lines.
It is also easy to see that if two bipartitions have no block larger than $2$,
their product also has no block larger than $2$: any transversal can only
contain one point in $\bn$ and one point in $\bn'$, so any transversal in the
product can only contain two points.  The upper and lower blocks of the product
are inherited from the original bipartitions, so they will not break the
condition either.

The Motzkin monoid $\Mot_n$ grows much slower than its parent $\Prt_n$, having
only $\sum_{k=0}^n \binom{2n}{2k}C_k$ elements
\cite[\href{https://oeis.org/A026945}{A026945}]{oeis}, where $C_k$ is the $k$th
Catalan number.  Its size in comparison with $\Prt_n$ is shown in Table
\ref{tab:mn-size}.

\begin{table}[h]
  \centering
  \renewcommand\arraystretch{1.0}
  \begin{tabular}{| r | r | r |}
    \hline
    $n$ & $|\Mot_n|$ & $|\Prt_n|$ \\
    \hline
     1 &           2 &                  2 \\
     2 &           9 &                 15 \\
     3 &          51 &                203 \\
     4 &         323 &              4 140 \\
     5 &       2 188 &            115 975 \\
     6 &      15 511 &          4 213 597 \\
     7 &     113 634 &        190 899 322 \\
     8 &     853 467 &     10 480 142 147 \\
     9 &   6 536 382 &    682 076 806 159 \\
    10 &  50 852 019 & 51 724 158 235 372 \\
    \hline
  \end{tabular}
  \renewcommand\arraystretch{0.7}
  \caption{Sizes of $\Mot_n$ and $\Prt_n$ for small values of $n$}
  \label{tab:mn-size}
\end{table}

The Motzkin monoid $\Mot_n$ shares a number of features with $\Prt_n$---indeed,
we will see later that its congruence lattice is very similar.  Like $\Prt_n$,
$\Mot_n$ is regular with a possible inverse given by the $^\star$
function. Another important similarity is in its Green's relations: consider the
following proposition, akin to Proposition \ref{prop:bipartition-greens}.

\begin{proposition}
  \label{prop:mn-greens}
  Let $\alpha$ and $\beta$ be bipartitions in $\Mot_n$.  The following hold:
  \begin{enumerate}[\rm(i)]
  \item $\alpha \RR \beta$ if and only if $\dom \alpha = \dom \beta$ and
    $\ker \alpha = \ker \beta$;
  \item $\alpha \LL \beta$ if and only if $\codom \alpha = \codom \beta$ and
    $\coker \alpha = \coker \beta$;
  \item $\alpha \JJ \beta$ if and only if $\rank \alpha = \rank \beta$;
  \item $J_\alpha \leq J_\beta$ if and only if $\rank \alpha \leq \rank \beta$;
  \item the ideals of $\Mot_n$ are precisely the sets
    $I_r=\{\alpha \in \Mot_n : \rank \alpha \leq r\}$ for
    $r \in \{0, \ldots, n\}$.
  \end{enumerate}
  \begin{proof}
    For (i) to (iii), see \cite[Theorem 2.4]{deg_motzkin}.  For (iv) and (v),
    see \cite[Proposition 2.6]{deg_motzkin}.
    % TODO: actually give the proof
  \end{proof}
\end{proposition}

This description of the Motzkin monoid's Green's relations, and its containment
of $\JJ$-classes and ideals, will help us greatly later on.  However, one
consequence of (i) and (ii) gives $\Mot_n$ a feature which $\Prt_n$ does not
share, namely the following corollary.

\begin{corollary}
  \label{cor:mn-h-trivial}
  The Motzkin monoid $\Mot_n$ is $\HH$-trivial.
  \begin{proof}
    Let $\alpha, \beta \in \Mot_n$ such that $\alpha \HH \beta$.  This tells us
    that $\alpha \LL \beta$ and $\alpha \RR \beta$, so by Proposition
    \ref{prop:mn-greens} parts (i) and (ii), we know that $\alpha$ and $\beta$
    share the same domain, kernel, codomain and cokernel.  The upper blocks and
    lower blocks of $\alpha$ and $\beta$ must certainly be the same, since they
    are just the blocks of the kernel and cokernel that do not lie in the domain
    or codomain.  The only choice is in the transversals: which blocks in the
    domain connect to which blocks in the codomain.  In $\Prt_n$ there are
    $(\rank \alpha)!$ ways of choosing this match-up; but in $\Mot_n$ there is
    only one way possible, since we cannot allow any lines in the diagram to
    cross.  Hence $\alpha = \beta$.
  \end{proof}
\end{corollary}


\section{Lifted congruences}
\label{sec:motzkin-prelim}
We will now define some concepts which allow us to find certain
congruences in any semigroup: \textit{retractable ideals} (Definition
\ref{def:retractable-ideal}) and \textit{liftable congruences} (Definition
\ref{def:liftable-congruence}).  It will turn out that all non-Rees congruences
of $\Mot_n$ can be found using these two building blocks.

\begin{definition}
  \label{def:retractable-ideal}
  \index{retractable ideal} \index{retraction}
  Let $S$ be a finite semigroup, with minimal ideal $M$.  An ideal $I$ of $S$ is
  called \textbf{retractable} if there exists some homomorphism $\phi: I \to M$
  such that $(m)\phi = m$ for all $m \in M$; we call $\phi$ a
  \textbf{retraction}.
\end{definition}

\begin{definition}
  \label{def:liftable-congruence}
  \index{liftable congruence}
  \nomenclature{$\xi$}{Liftable congruence}
  Let $S$ be a finite semigroup, with minimal ideal $M$.  A congruence $\sigma$
  on $M$ is \textbf{liftable} if any, and therefore all, of the following
  conditions are satisfied:
  \begin{enumerate}[\rm(i)]
  \item $\sigma \cup \Delta_S$ is a congruence on $S$;
  \item there exists some congruence $\bar\sigma$ on $S$ such that
    $\sigma= \bar\sigma \cap (M \times M)$;
  \item $(ax,bx),(xa,xb) \in \sigma$ for all pairs $(a,b) \in \sigma$ and
    elements $x \in S$.
  \end{enumerate}
\end{definition}

In order to use these building blocks to produce new congruences, we first need
to establish some results about them.  Note that, since $\Mot_n$ is finite, it
must have a minimal ideal.  More specifically, the minimal ideal of $\Mot_n$ is
given by $I_0 = \{\alpha \in \Mot_n : \rank \alpha = 0\}$ (see Proposition
\ref{prop:mn-greens}).  The following lemma will be used at various times
throughout this chapter.

\begin{lemma}
  \label{lem:retract-aux}
  Let $S$ be a finite semigroup, with regular minimal ideal $M$, and let $I$ be
  an ideal of $S$.  If $I$ is retractable and $\phi: I \rightarrow M$ is a
  retraction from $I$ to $M$, then $(sxt)\phi=s \cdot (x)\phi \cdot t$ for all
  elements $x\in I$ and $s,t\in S^1$.
  \begin{proof}
    Firstly, let us consider left multiplication.  Since $M$ is regular, any
    element $m \in M$ has an inverse $m' \in M$, a left identity given by $mm'$,
    and a right identity given by $m'm$.  Let $e$ be a right
    identity for $(x)\phi$, so that
    $(x)\phi \cdot e = (x)\phi$.
    Since $\phi$ is a retraction and $e, xe \in M$, we have
    $$(x)\phi=(x)\phi \cdot e = (x)\phi \cdot (e)\phi = (xe)\phi = xe,$$
    so $(x)\phi = xe$.  Now let $f$ be a left identity for $(sx)\phi$; we also
    have
    \begin{align*}
      (sx)\phi \cdot e & = f \cdot (sx)\phi \cdot e \\
      & = (f)\phi \cdot (sx)\phi \cdot e \\
      & = (fsx)\phi \cdot e \\
      & = (fs)\phi \cdot (x)\phi \cdot e \\
      & = (fs)\phi \cdot (x)\phi \\
      & = (fsx)\phi \\
      & = (f)\phi \cdot (sx)\phi \\
      & = f \cdot (sx)\phi \\
      & = (sx)\phi,
    \end{align*}
    which shows that $e$ is a right identity for $(sx)\phi$ as well as for
    $(x)\phi$.  Hence we have
    $s \cdot (x)\phi = s \cdot xe = (sxe)\phi = (sx)\phi \cdot (e)\phi =
    (sx)\phi \cdot e = (sx)\phi$, so $\phi$ respects left multiplication; a
    symmetric argument gives $(xt)\phi = (x)\phi \cdot t$, so $\phi$ respects
    right multiplication too.  Finally we can combine these to give
    $(sxt)\phi = (sx)\phi \cdot t = s \cdot (x)\phi \cdot t$, as required.
  \end{proof}
\end{lemma}

This lemma gives rise to an important corollary which we can use later when we
combine retractable ideals with liftable congruences.  Note first that, since
$\Mot_n$ is a regular semigroup, its minimal ideal is also regular.

\begin{corollary}
  \label{cor:retract-unique}
  Let $S$ be a finite semigroup, with regular minimal ideal $M$.  If $I$ is a
  retractable ideal of $S$, then the retraction $\phi:I \to M$ is unique.
  \begin{proof}
    Let $\phi$ and $\psi$ be retractions from $I$ to $M$.  Let $x \in I$,
    and let $e_l$ and $e_r$ be left and right identities for $(x)\phi$.  By
    Lemma \ref{lem:retract-aux}, we have
    $$(x)\phi
    = e_l \cdot (x)\phi
    = (e_lx)\phi
    = e_lx
    = (e_lx)\psi
    = e_l \cdot (x)\psi,$$
    so $(x)\phi = e_l \cdot (x)\psi$, and a symmetric argument gives us
    $(x)\psi = (x)\phi \cdot e_r$.  But then
    $$(x)\phi
    = e_l \cdot (x)\psi
    = e_l \cdot (x)\phi \cdot e_r
    = (x)\phi \cdot e_r
    = (x)\psi,$$
    so $\phi = \psi$.
  \end{proof}
\end{corollary}

The effect of Corollary \ref{cor:retract-unique} is that, for a semigroup with a
regular minimal ideal, we can talk about \textit{the} retraction of a
retractable ideal without any loss of generality.  This result is the last thing
we need to use our two building blocks to produce a new congruence: a
\textit{lifted congruence}.

\begin{definition}
  \label{def:lifted-congruence}
  \index{lifted congruence}
  Let $S$ be a semigroup with a minimal ideal $M$, let $I$ be a retractable
  ideal of $S$, and let $\sigma$ be a liftable congruence on $M$.  We associate to
  the pair $(I,\sigma)$ the relation
  $$\zeta_{I,\sigma}
  = \{(x,y) \in I \times I : (x\phi,y\phi) \in \sigma\} \cup \Delta_S,$$
  where $\phi$ is the unique retraction $I \to M$.
  We call $\zeta_{I,\sigma}$ the \textbf{lifted congruence} of $(I,\sigma)$.
\end{definition}

In order to justify the name \textit{lifted congruence}, we require the
following proposition.

\begin{proposition}
  \label{prop:lift}
  The relation $\zeta_{I,\sigma}$ in Definition \ref{def:lifted-congruence} is a
  congruence on $S$.
  \begin{proof}
    For conciseness, let us refer to $\zeta_{I,\sigma}$ as $\zeta$.  Let $(x,y)$
    be a pair in $\zeta$ and let $s \in S$.  To show $\zeta$ is a congruence, we
    must show that $(sx,sy)$ and $(xs,ys)$ both lie in $\zeta$.  If
    $(x,y) \in \Delta_S$, this is certainly true.  Otherwise, we have
    $x, y \in I$ and $(x\phi, y\phi) \in \sigma$.  Since $I$ is an ideal, we
    certainly have $xs,ys\in I$.  Now by Definition
    \ref{def:liftable-congruence} part (iii), and by Lemma
    \ref{lem:retract-aux}, we have
    $(sx)\phi = s \cdot (x)\phi \mathrel\sigma s \cdot (y)\phi = (sy)\phi$, so
    that $(sx, sy) \in \zeta$.  A symmetric argument gives us
    $(xs,ys) \in \zeta$.
  \end{proof}
\end{proposition}

This construction now gives us a usable source of congruences.  All that is
required is to find some liftable congruences and retractable ideals of a
semigroup, and a number of new congruences can be described.  It turns out that
this is an excellent source of congruences for $\Mot_n$, yielding every non-Rees
congruence on the semigroup, as we will see later.

\section{Congruence lattice of $\Mot_n$}
\label{sec:motzkin-congs}

% L,R,H,Delta,Univ are liftable congs: lambda, rho, mu, eta, R

% ^ notation
% Show ^:I1->I0 is a retraction

% Describe the congruences:
% mu0, lam0, rho0, R0,
% mu1, lam1, rho1, R1,
% R2 ... Rn

% How do they fit together?

% Show the lattice

% Proof of exhaustion: table of generating pairs, with references to propositions

\section{Other monoids}
\label{sec:motzkin-other}
