\chapter{Congruences of the Motzkin monoid}
\label{chap:motzkin}

In Chapter \ref{chap:lattice} we explained a relatively quick way of computing
all of a semigroup's congruences, along with information about how they fit into
their lattice structure.  This was implemented in the Semigroups package
\cite{semigroups}, greatly increasing the size and complexity of semigroups
whose congruence lattices can be found using a computer.

One of the first semigroups towards which this new methodology was directed was
the bipartition monoid $\Prt_n$, whose congruence lattice was not previously
known.  Computing this lattice for the first few values of $n$ showed a lattice
with a relatively simple structure, which did not appear to increase much in
complexity as $n$ grew higher than $3$.  The congruence lattices of various
submonoids of $\Prt_n$ were also computed, and appeared to have a similar
structure.  With the rapidly increasing size of $\Prt_n$ (see Table
\ref{tab:pn-size}) it proved impractical to na\"ively calculate the congruence
lattices beyond $n=4$, but careful study of the lattices for small values of
$n$, along with those lattices computed for various submonoids of $\Prt_n$,
yielded a general classification of the congruence lattice of $\Prt_n$ for
arbitrary $n$, along with a classification of the congruence lattices of various
important submonoids.  This classification is explained and proven in
\cite{ourpaper}, the paper upon which this chapter is based.

In this chapter, we will examine the structure of these congruence lattices,
focusing in particular on the Motzkin monoid $\Mot_n$, which was the present
author's particular focus when contributing to \cite{ourpaper}.  Much of this
content is contained in some form in that paper, and is included in this thesis
by the kind permission of my co-authors.  We will start with the definition of
the Motzkin monoid, then describe some preliminary theory, then describe the
Motzkin monoid's lattice of congruences (Theorem \ref{thm:mn-congs}), and
finally give a brief description of how these ideas can be extended to $\Prt_n$
and its other submonoids.

\section{The Motzkin monoid $\Mot_n$}
\label{sec:motzkin-monoid}
In order to define the Motzkin monoid, we must first define a \textit{planar}
bipartition.

\begin{definition}
  \label{def:planar}
  \index{planar bipartition}
  A bipartition is called \textbf{planar} if it can be represented in diagram
  form with all edges contained inside the rectangle formed by the vertices,
  without any edges crossing.
\end{definition}

\begin{example}
  Let $\alpha = \bipart{c|c|c|c}{2-4}{1,2 &3 &4 &5}{2,5 &1 &\mc2{c}{3,4}}$ and
  $\beta = \bipart{c|c|c|c}{3-4}{2 &5 &1,3 &4}{1 &3,4 &2 &5}$.  As can be seen
  in Figure \ref{fig:planar}, $\alpha$ is planar.  However, $\beta$ cannot be
  drawn inside the rectangle without the upper block $\{1,3\}$ crossing lines
  with the transversal $\{2, 1'\}$---hence, $\beta$ is not planar.
\end{example}

\begin{figure}[h]
  \centering
  $$\alpha = \bipartdiag{\tc12\tv22\bC25 \bc34} \qquad
  \beta = \bipartdiag{\tc13 \tv21 \tv54\bc34}$$
  \caption{A planar and a non-planar bipartition}
  \label{fig:planar}
\end{figure}

We can now define the Motzkin monoid.

\begin{definition}
  \label{def:motzkin}
  \index{Motzkin monoid}
  \nomenclature[Mn]{$\Mot_n$}{Motzkin monoid}
  The \textbf{Motzkin monoid} $\Mot_n$ is the submonoid of $\Prt_n$ consisting
  of all planar bipartitions of degree $n$ in which every block has size $1$ or
  $2$.
\end{definition}

To see that this is indeed a monoid, we should observe that it is closed.  It is
easy to see that the product of two planar bipartitions is also planar, since a
double diagram as in Figure \ref{fig:bipartition-example} would contain no
crossing lines, and therefore would resolve to a product with no crossing lines.
It is also easy to see that if two bipartitions have no block larger than $2$,
their product also has no block larger than $2$: any transversal can only
contain one point in $\bn$ and one point in $\bn'$, so any transversal in the
product can only contain two points.  The upper and lower blocks of the product
are inherited from the original bipartitions, so they will not break the
condition either.

The Motzkin monoid $\Mot_n$ grows much slower than its parent $\Prt_n$, having
only $\sum_{k=0}^n \binom{2n}{2k}C_k$ elements
\cite[\href{https://oeis.org/A026945}{A026945}]{oeis}, where $C_k$ is the $k$th
Catalan number.  Its size in comparison with $\Prt_n$ is shown in Table
\ref{tab:mn-size}.

\begin{table}[h]
  \centering
  \renewcommand\arraystretch{1.0}
  \begin{tabular}{| r | r | r |}
    \hline
    $n$ & $|\Mot_n|$ & $|\Prt_n|$ \\
    \hline
     1 &           2 &                  2 \\
     2 &           9 &                 15 \\
     3 &          51 &                203 \\
     4 &         323 &              4 140 \\
     5 &       2 188 &            115 975 \\
     6 &      15 511 &          4 213 597 \\
     7 &     113 634 &        190 899 322 \\
     8 &     853 467 &     10 480 142 147 \\
     9 &   6 536 382 &    682 076 806 159 \\
    10 &  50 852 019 & 51 724 158 235 372 \\
    \hline
  \end{tabular}
  \renewcommand\arraystretch{0.7}
  \caption{Sizes of $\Mot_n$ and $\Prt_n$ for small values of $n$}
  \label{tab:mn-size}
\end{table}

The Motzkin monoid $\Mot_n$ shares a number of features with $\Prt_n$---indeed,
we will see later that its congruence lattice is very similar.  Like $\Prt_n$,
$\Mot_n$ is regular with a possible inverse given by the $^\star$
function. Another important similarity is in its Green's relations: consider the
following proposition, akin to Proposition \ref{prop:bipartition-greens}.

\begin{proposition}
  \label{prop:mn-greens}
  \nomenclature[Ik]{$I_k$}{Ideal of the Motzkin monoid $\Mot_n$}
  Let $\alpha$ and $\beta$ be bipartitions in $\Mot_n$.  The following hold:
  \begin{enumerate}[\rm(i)]
  \item $\alpha \RR \beta$ if and only if $\dom \alpha = \dom \beta$ and
    $\ker \alpha = \ker \beta$;
  \item $\alpha \LL \beta$ if and only if $\codom \alpha = \codom \beta$ and
    $\coker \alpha = \coker \beta$;
  \item $\alpha \JJ \beta$ if and only if $\rank \alpha = \rank \beta$;
  \item $J_\alpha \leq J_\beta$ if and only if $\rank \alpha \leq \rank \beta$;
  \item the ideals of $\Mot_n$ are precisely the sets
    $I_k=\{\alpha \in \Mot_n : \rank \alpha \leq k\}$ for
    $k \in \{0, \ldots, n\}$.
  \end{enumerate}
  \begin{proof}
    For (i) to (iii), see \cite[Theorem 2.4]{deg_motzkin}.  For (iv) and (v),
    see \cite[Proposition 2.6]{deg_motzkin}.
    % TODO: actually give the proof
  \end{proof}
\end{proposition}

This description of the Motzkin monoid's Green's relations, and its containment
of $\JJ$-classes and ideals, will help us greatly later on.  However, one
consequence of (i) and (ii) gives $\Mot_n$ a feature which $\Prt_n$ does not
share, namely the following corollary.

\begin{corollary}
  \label{cor:mn-h-trivial}
  The Motzkin monoid $\Mot_n$ is $\HH$-trivial.
  \begin{proof}
    Let $\alpha, \beta \in \Mot_n$ such that $\alpha \HH \beta$.  This tells us
    that $\alpha \LL \beta$ and $\alpha \RR \beta$, so by Proposition
    \ref{prop:mn-greens} parts (i) and (ii), we know that $\alpha$ and $\beta$
    share the same domain, kernel, codomain and cokernel.  The upper blocks and
    lower blocks of $\alpha$ and $\beta$ must certainly be the same, since they
    are just the blocks of the kernel and cokernel that do not lie in the domain
    or codomain.  The only choice is in the transversals: which blocks in the
    domain connect to which blocks in the codomain.  In $\Prt_n$ there are
    $(\rank \alpha)!$ ways of choosing this match-up; but in $\Mot_n$ there is
    only one way possible, since we cannot allow any lines in the diagram to
    cross.  Hence $\alpha = \beta$.
  \end{proof}
\end{corollary}

Finally, we will state one other feature of $\Mot_n$ which distinguishes it from
$\Prt_n$---an interesting property of its minimal ideal $I_0$.

\begin{lemma}
  \label{lem:i0-rect-band}
  Let $\alpha$ and $\beta$ be bipartitions in $I_0$, the minimal ideal of
  $\Mot_n$.  Then $\alpha \beta \alpha = \alpha$.
  % The product $\alpha\beta$ has the following proprties: $\ker\alpha\beta = \ker\alpha$,
  % $\coker\alpha\beta = \coker\beta$, and
  % $\dom\alpha\beta = \codom\alpha\beta = \varnothing$.
  \begin{proof}
    Since $\alpha$ has no transversals, $\alpha\beta\alpha$ also has no
    transversals.  The upper blocks of a product are equal to its first
    component, the lower blocks to its last component---so $\alpha\beta\alpha$
    has the upper and lower blocks of $\alpha$.  Hence it equals $\alpha$.
  \end{proof}
\end{lemma}

The lemma above establishes that $I_0$ is a \textit{rectangular band}, an
interesting class of regular semigroup---see \cite[\S4.4]{howie} for a
discussion of these. \index{rectangular band}

\section{Lifted congruences}
\label{sec:motzkin-prelim}
We will now define some concepts which allow us to find certain
congruences in any semigroup: \textit{retractable ideals} (Definition
\ref{def:retractable-ideal}) and \textit{liftable congruences} (Definition
\ref{def:liftable-congruence}).  It will turn out that all non-Rees congruences
of $\Mot_n$ can be found using these two building blocks.

\begin{definition}
  \label{def:retractable-ideal}
  \index{retractable ideal} \index{retraction}
  Let $S$ be a finite semigroup, with minimal ideal $M$.  An ideal $I$ of $S$ is
  called \textbf{retractable} if there exists some homomorphism $\phi: I \to M$
  such that $(m)\phi = m$ for all $m \in M$; we call $\phi$ a
  \textbf{retraction}.
\end{definition}

\begin{definition}
  \label{def:liftable-congruence}
  \index{liftable congruence}
  \nomenclature{$\sigma$}{Liftable congruence}
  Let $S$ be a finite semigroup, with minimal ideal $M$.  A congruence $\sigma$
  on $M$ is \textbf{liftable congruence} of $S$ if any, and therefore all, of
  the following equivalent conditions are satisfied:
  \begin{enumerate}[\rm(i)]
  \item $\sigma \cup \Delta_S$ is a congruence on $S$;
  \item there exists some congruence $\bar\sigma$ on $S$ such that
    $\sigma= \bar\sigma \cap (M \times M)$;
  \item $(ax,bx),(xa,xb) \in \sigma$ for all pairs $(a,b) \in \sigma$ and
    elements $x \in S$.
  \end{enumerate}
\end{definition}

In order to use these building blocks to produce new congruences, we first need
to establish some results about them.  Note that, since $\Mot_n$ is finite, it
must have a minimal ideal.  More specifically, the minimal ideal of $\Mot_n$ is
given by $I_0 = \{\alpha \in \Mot_n : \rank \alpha = 0\}$ (see Proposition
\ref{prop:mn-greens}).  The following lemma will be used at various times
throughout this chapter.

\begin{lemma}
  \label{lem:retract-aux}
  Let $S$ be a finite semigroup, with regular minimal ideal $M$, and let $I$ be
  an ideal of $S$.  If $I$ is retractable and $\phi: I \rightarrow M$ is a
  retraction from $I$ to $M$, then $(sxt)\phi=s \cdot (x)\phi \cdot t$ for all
  elements $x\in I$ and $s,t\in S^1$.
  \begin{proof}
    Firstly, let us consider left multiplication.  Since $M$ is regular, any
    element $m \in M$ has an inverse $m' \in M$, a left identity given by $mm'$,
    and a right identity given by $m'm$.  Let $e$ be a right
    identity for $(x)\phi$, so that
    $(x)\phi \cdot e = (x)\phi$.
    Since $\phi$ is a retraction and $e, xe \in M$, we have
    $$(x)\phi=(x)\phi \cdot e = (x)\phi \cdot (e)\phi = (xe)\phi = xe,$$
    so $(x)\phi = xe$.  Now let $f$ be a left identity for $(sx)\phi$; we also
    have
    \begin{align*}
      (sx)\phi \cdot e & = f \cdot (sx)\phi \cdot e \\
      & = (f)\phi \cdot (sx)\phi \cdot e \\
      & = (fsx)\phi \cdot e \\
      & = (fs)\phi \cdot (x)\phi \cdot e \\
      & = (fs)\phi \cdot (x)\phi \\
      & = (fsx)\phi \\
      & = (f)\phi \cdot (sx)\phi \\
      & = f \cdot (sx)\phi \\
      & = (sx)\phi,
    \end{align*}
    which shows that $e$ is a right identity for $(sx)\phi$ as well as for
    $(x)\phi$.  Hence we have
    $s \cdot (x)\phi = s \cdot xe = (sxe)\phi = (sx)\phi \cdot (e)\phi =
    (sx)\phi \cdot e = (sx)\phi$, so $\phi$ respects left multiplication; a
    symmetric argument gives $(xt)\phi = (x)\phi \cdot t$, so $\phi$ respects
    right multiplication too.  Finally we can combine these to give
    $(sxt)\phi = (sx)\phi \cdot t = s \cdot (x)\phi \cdot t$, as required.
  \end{proof}
\end{lemma}

This lemma gives rise to an important corollary which we can use later when we
combine retractable ideals with liftable congruences.  Note first that, since
$\Mot_n$ is a regular semigroup, its minimal ideal is also regular.

\begin{corollary}
  \label{cor:retract-unique}
  Let $S$ be a finite semigroup, with regular minimal ideal $M$.  If $I$ is a
  retractable ideal of $S$, then the retraction $\phi:I \to M$ is unique.
  \begin{proof}
    Let $\phi$ and $\psi$ be retractions from $I$ to $M$.  Let $x \in I$,
    and let $e_l$ and $e_r$ be left and right identities for $(x)\phi$.  By
    Lemma \ref{lem:retract-aux}, we have
    $$(x)\phi
    = e_l \cdot (x)\phi
    = (e_lx)\phi
    = e_lx
    = (e_lx)\psi
    = e_l \cdot (x)\psi,$$
    so $(x)\phi = e_l \cdot (x)\psi$, and a symmetric argument gives us
    $(x)\psi = (x)\phi \cdot e_r$.  But then
    $$(x)\phi
    = e_l \cdot (x)\psi
    = e_l \cdot (x)\phi \cdot e_r
    = (x)\phi \cdot e_r
    = (x)\psi,$$
    so $\phi = \psi$.
  \end{proof}
\end{corollary}

The effect of Corollary \ref{cor:retract-unique} is that, for a semigroup with a
regular minimal ideal, we can talk about \textit{the} retraction of a
retractable ideal without any loss of generality.  This result is the last thing
we need to use our two building blocks to produce a new congruence: a
\textit{lifted congruence}.

\begin{definition}
  \label{def:lifted-congruence}
  \index{lifted congruence}
  Let $S$ be a semigroup with a minimal ideal $M$, let $I$ be a retractable
  ideal of $S$, and let $\sigma$ be a liftable congruence of $S$.  We associate
  to the pair $(I,\sigma)$ the relation
  $$\zeta_{I,\sigma}
  = \{(x,y) \in I \times I : (x\phi,y\phi) \in \sigma\} \cup \Delta_S,$$
  where $\phi$ is the unique retraction $I \to M$.
  We call $\zeta_{I,\sigma}$ the \textbf{lifted congruence} of $(I,\sigma)$.
\end{definition}

In order to justify the name \textit{lifted congruence}, we require the
following proposition.

\begin{theorem}
  \label{thm:lifted-congruence}
  The relation $\zeta_{I,\sigma}$ in Definition \ref{def:lifted-congruence} is a
  congruence on $S$.
  \begin{proof}
    For conciseness, let us refer to $\zeta_{I,\sigma}$ as $\zeta$.  Let $(x,y)$
    be a pair in $\zeta$ and let $s \in S$.  To show $\zeta$ is a congruence, we
    must show that $(sx,sy)$ and $(xs,ys)$ both lie in $\zeta$.  If
    $(x,y) \in \Delta_S$, this is certainly true.  Otherwise, we have
    $x, y \in I$ and $(x\phi, y\phi) \in \sigma$.  Since $I$ is an ideal, we
    certainly have $xs,ys\in I$.  Now by Definition
    \ref{def:liftable-congruence} part (iii), and by Lemma
    \ref{lem:retract-aux}, we have
    $(sx)\phi = s \cdot (x)\phi \mathrel\sigma s \cdot (y)\phi = (sy)\phi$, so
    that $(sx, sy) \in \zeta$.  A symmetric argument gives us
    $(xs,ys) \in \zeta$.
  \end{proof}
\end{theorem}

This construction now gives us a usable source of congruences.  All that is
required is to find some liftable congruences and retractable ideals of a
semigroup, and a number of new congruences can be described.  It turns out that
this is an excellent source of congruences for $\Mot_n$, yielding every non-Rees
congruence on the semigroup, as we will see later.

\section{Congruence lattice of $\Mot_n$}
\label{sec:motzkin-congs}

% Rees congruences

We can now apply the general theory of Section \ref{sec:motzkin-prelim} to the
Motzkin monoid, in order to find its congruences.  First, let us mention the
easiest congruences to describe---its Rees congruences (Definition
\ref{def:rees-congruence}).

\begin{proposition}
  \label{prop:motzkin-rees}
  \nomenclature[Rk]{$R_k$}{Rees congruence of the Motzkin monoid $\Mot_n$}
  The Rees congruences of $\Mot_n$ are the relations
  $$R_k = \{(x,y) \in \Mot_n \times \Mot_n : \rank x, \rank y \leq k\} \cup
  \Delta_{\Mot_n},$$
  for $k \in \{0, \ldots, n\}$.
  \begin{proof}
    This follows immediately from the description of the ideals of $\Mot_n$ in
    Proposition \ref{prop:mn-greens} part (v).
  \end{proof}
\end{proposition}

We will refer to these congruences by the name $R_k$ for the rest of this
chapter.  We will soon see that $R_0$ and $R_1$ are in fact lifted congruences,
but the higher Rees congruences may not be.  Next, we will describe some other
lifted congruences, by identifying some liftable congruences and retractions in
$\Mot_n$ to use as building blocks.

% L,R,H,Delta,Univ are liftable congs: lambda, rho, mu, eta, R
First, recall that $I_0 = \{\alpha \in \Mot_n : \rank \alpha = 0\}$ is the
minimal ideal of $\Mot_n$.  Let us denote by $\LL_0$ and $\RR_0$ the $\LL$ and
$\RR$ relations of $\Mot_n$ restricted to $I_0$, and let $\Delta_0$ and
$\nabla_0$ be abbreviations for $\Delta_{I_0}$ and $\nabla_{I_0}$ respectively.
\nomenclature{$\Delta_0$}{Trivial congruence on the ideal $I_0$}
\nomenclature{$\nabla_0$}{Universal congruence on the ideal $I_0$}
\nomenclature[L0]{$\LL_0$}{Green's $\LL$ relation retricted to the ideal $I_0$}
\nomenclature[R0]{$\RR_0$}{Green's $\RR$ relation retricted to the ideal $I_0$}

\begin{proposition}
  The relations $\Delta_0$, $\LL_0$, $\RR_0$ and $\nabla_0$ are all
  liftable congruences of $\Mot_n$.
  \begin{proof}
    Since $I_0$ is a semigroup, $\Delta_0$ and $\nabla_0$ are certainly
    congruences of $I_0$; and both satisfy Definition
    \ref{def:liftable-congruence} (i), since their unions with $\Delta_{\Mot_n}$
    are the congruences $\Delta_{\Mot_n}$ and $R_0$ respectively.

    To see that $\LL_0$ is a liftable congruence, consider Definition
    \ref{def:liftable-congruence} (iii); let $(a,b) \in \LL_0$ and
    $x \in \Mot_n$.  Since $I_0$ is the minimal ideal, we certainly have
    $xa,xb,ax,bx \in I_0$.  And since $\LL$ is a right congruence on $\Mot_n$
    (see Proposition \ref{prop:greens-as-congs}) we have $(ax,bx) \in \LL$ and
    therefore $(ax,bx) \in \LL_0$.  By Lemma \ref{lem:i0-rect-band} we also have
    $a(xa) = a$, so $xa \LL a$ and similarly $xb \LL b$.  This means that
    $xa \LL a \LL b \LL xb$, so $(xa, xb) \in \LL_0$.  Hence $\LL_0$ is a
    liftable congruence of $\Mot_n$, and by a similar argument, so is $\RR_0$.
  \end{proof}
\end{proposition}

% ^ notation
Now that we have some liftable congruences, we also want some retractable ideals
in order to form lifted congruences.  The following construction establishes one
such ideal.

\begin{definition}
  \label{def:mn-hat}
  \nomenclature[^]{$\widehat{\phantom\alpha}$}{Bipartition of rank $0$ with this
    kernel and cokernel}
  If $\alpha$ is a bipartition, then $\widehat\alpha$ is the unique bipartition
  of rank $0$ with the same kernel and cokernel as $\alpha$.
\end{definition}

The element $\widehat\alpha$ can be computed easily from $\alpha$: each
transversal is split into an upper block (the points in $\bn$) and a lower block
(the points in $\bn'$) and nothing else is changed.  If we have a diagram for
$\alpha$, drawn in the standard way described after Example
\ref{ex:bipartition}, then we simply remove any lines crossing the diagram.  If
we are using two-row notation, we can simply draw a horizontal line between the
two rows.  See Figure \ref{fig:hat} for an example.  Note that $\widehat\alpha =
\alpha$ for all $\alpha \in I_0$.

\begin{figure}[h]
  \centering
  $$\alpha = \big\{
    \{1,3,4,1'\}, \{2,3',4'\}, \{5\}, \{2'\}, \{5'\}
  \big\}$$
  $$\widehat\alpha = \big\{
    \{1,3,4\}, \{1'\}, \{2\}, \{3',4'\}, \{5\}, \{2'\}, \{5'\}
  \big\}$$
  $$\alpha = \bipartdiag{\tv11\tc13\tc34 \tv23\bc34} \quad
  \widehat\alpha = \bipartdiag{\tc13\tc34 \bc34}$$
  $$\alpha = \bipart{c|c|c|c}{3-4}{1,3,4 & 2 & \mc2c5}{1 & 3,4 & 2 & 5} \quad
  \widehat\alpha = \bipart{c|c|c|c}{1-4}{1,3,4 & 2 & \mc2c5}{1 & 3,4 & 2 & 5}$$
  \caption{Computing $\widehat\alpha$ from $\alpha$}
  \label{fig:hat}
\end{figure}

% Show ^:I1->I0 is a retraction
\begin{proposition}
  \label{prop:hat-retraction}
  The map $\phi: I_1 \to I_0$ defined by $\alpha \mapsto \widehat\alpha$ is a
  retraction.  Hence, $I_1$ is a retractable ideal.
  \begin{proof}
    First, we will show that $\phi$ is a homomorphism.  Let
    $\alpha,\beta \in I_1$---we will try to prove that
    $\widehat{\alpha\beta} = \widehat\alpha \widehat\beta$.  If both $\alpha$
    and $\beta$ have rank $0$ then
    $\widehat{\alpha\beta} = \alpha\beta = \widehat\alpha \widehat\beta$.  On
    the other hand, if at least one of $\alpha$ and $\beta$ has rank $1$ (without
    loss of generality, $\alpha$) then we may write
    $\alpha = \bipart{c|c|c|c}{2-4}{A_0&A_1&\ldots&A_r}{B_0&B_1&\ldots&B_s}$ and
    $\beta = \bipart{c|c|c|c}{2-4}{C_0&C_1&\ldots&C_t}{D_0&D_1&\ldots&D_u}$ or
    $\beta = \bipart{c|c|c|c}{1-4}{C_0&C_1&\ldots&C_t}{D_0&D_1&\ldots&D_u}$.
    This gives us
    $\alpha\beta =
    \bipart{c|c|c|c}{2-4}{A_0&A_1&\ldots&A_r}{D_0&D_1&\ldots&D_u}$ or
    $\alpha\beta =
    \bipart{c|c|c|c}{1-4}{A_0&A_1&\ldots&A_r}{D_0&D_1&\ldots&D_u}$.  Applying
    $\phi$ gives us
    $\widehat\alpha =
    \bipart{c|c|c|c}{1-4}{A_0&A_1&\ldots&A_r}{B_0&B_1&\ldots&B_s}$,
    $\widehat\beta =
    \bipart{c|c|c|c}{1-4}{C_0&C_1&\ldots&C_t}{D_0&D_1&\ldots&D_u}$, and finally
    $\widehat{\alpha\beta} =
    \bipart{c|c|c|c}{1-4}{A_0&A_1&\ldots&A_r}{D_0&D_1&\ldots&D_u} =
    \widehat\alpha \widehat\beta$, so $\phi$ is a homomorphism.  Since
    $\widehat\alpha = \alpha$ for $\alpha \in I_0$, we can see that $\phi$ is a
    retraction, as required.
  \end{proof}
\end{proposition}

This gives us a retractable ideal $I_1$, with a retraction
$\alpha \mapsto \widehat\alpha$.  It is also trivial to see that $I_0$ itself is
retractable, with retraction $\alpha \mapsto \alpha$, the identity map.  Since
the minimal ideal $\I_0$ is regular, Corollary \ref{cor:retract-unique} shows
that these retractions are unique.

% Describe the congruences:
% mu0, lam0, rho0, R0,
% mu1, lam1, rho1, R1,
% R2 ... Rn
We now have four liftable congruences $\{\Delta_0, \LL_0, \RR_0, \nabla_0\}$ and
two retractable ideals $\{I_0, I_1\}$, giving rise to $4 \times 2 = 8$ lifted
congruences by Definition \ref{def:lifted-congruence} and Theorem
\ref{thm:lifted-congruence}.  The congruences lifted from $\nabla_0$ are
observed to be equal to the Rees congruences $R_0$ and $R_1$, while those lifted
from $\Delta_0$, $\LL_0$ and $\RR_0$ are named with appropriate Greek symbols,
as follows.
\begin{align*}
  \delta_0 &= \zeta_{I_0,\Delta_0}
  = \{(\alpha,\beta) \in I_0 \times I_0 :
    (\alpha, \beta) \in \Delta_0\} \cup \Delta_{\Mot_n} \\
  \delta_1 &= \zeta_{I_1,\Delta_0}
  = \{(\alpha,\beta) \in I_1 \times I_1 :
    (\widehat\alpha, \widehat\beta) \in \Delta_0\} \cup \Delta_{\Mot_n} \\
  \lambda_0 &=\zeta_{I_0,\LL_0}
  = \{(\alpha,\beta) \in I_0 \times I_0 :
    (\alpha, \beta) \in \LL_0\} \cup \Delta_{\Mot_n} \\
  \lambda_1 &= \zeta_{I_1,\LL_0}
  = \{(\alpha,\beta) \in I_1 \times I_1 :
    (\widehat\alpha, \widehat\beta) \in \LL_0\} \cup \Delta_{\Mot_n} \\
  \rho_0 &= \zeta_{I_0,\RR_0}
  = \{(\alpha,\beta) \in I_0 \times I_0 :
    (\alpha, \beta) \in \RR_0\} \cup \Delta_{\Mot_n} \\
  \rho_1 &= \zeta_{I_1,\RR_0}
  = \{(\alpha,\beta) \in I_1 \times I_1 :
    (\widehat\alpha, \widehat\beta) \in \RR_0\} \cup \Delta_{\Mot_n} \\
  R_0 &= \zeta_{I_0,\nabla_0}
  = \{(\alpha,\beta) \in I_0 \times I_0 :
    (\alpha, \beta) \in \nabla_0\} \cup \Delta_{\Mot_n} \\
  R_1 &= \zeta_{I_1,\nabla_0}
  = \{(\alpha,\beta) \in I_1 \times I_1 :
    (\widehat\alpha, \widehat\beta) \in \nabla_0\} \cup \Delta_{\Mot_n}
\end{align*}

This naming convention is summarised in Table \ref{tab:mn-lifted-congruences}.

\begin{table}[h]
  \centering
  \renewcommand\arraystretch{1.0}
  \begin{tabular}[h]{| c | c | c |}
    \cline{2-3}
    \mc1{c|}{} & $I_0$ & $I_1$ \\ \hline
    $\Delta_0$ & $\delta_0$ & $\delta_1$ \\ \hline
    $\LL_0$ & $\lambda_0$ & $\lambda_1$ \\ \hline
    $\RR_0$ & $\rho_0$ & $\rho_1$ \\ \hline
    $\nabla_0$ & $R_0$ & $R_1$ \\ \hline
  \end{tabular}
  \caption{Lifted congruences of $\Mot_n$}
  \label{tab:mn-lifted-congruences}
\end{table}

Interpreting these statements along with the use of Proposition
\ref{prop:mn-greens} gives the following characterisation of the lifted
congruences in terms of a bipartition's rank, kernel and cokernel.

\begin{proposition}
  \label{prop:mn-cong-char}
  The lifted congruences of $\Mot_n$ can be characterised in the following way,
  where $(\alpha, \beta) \in \Mot_n \times \Mot_n$:
  \begin{align*}
    \delta_0 &= \Delta_{\Mot_n} \\
    \delta_1 &= \{(\alpha,\beta) :
                  \rank\alpha,\rank\beta \leq 1,
                  \ker\alpha = \ker\beta,
                  \coker\alpha = \coker\beta\} \cup \Delta_{\Mot_n} \\
    \lambda_0 &= \{(\alpha,\beta) :
                   \rank\alpha,\rank\beta = 0,
                   \coker\alpha = \coker\beta\} \cup \Delta_{\Mot_n} \\
    \lambda_1 &= \{(\alpha,\beta) :
                   \rank\alpha,\rank\beta \leq 1,
                   \coker\alpha = \coker\beta\} \cup \Delta_{\Mot_n} \\
    \rho_0 &= \{(\alpha,\beta) :
                \rank\alpha,\rank\beta = 0,
                \ker\alpha = \ker\beta\} \cup \Delta_{\Mot_n} \\
    \rho_1 &= \{(\alpha,\beta) :
                \rank\alpha,\rank\beta \leq 1,
                \ker\alpha = \ker\beta\} \cup \Delta_{\Mot_n} \\
    R_0 &= \{(\alpha,\beta) :
             \rank\alpha,\rank\beta = 0\} \cup \Delta_{\Mot_n} \\
    R_1 &= \{(\alpha,\beta) :
             \rank\alpha,\rank\beta \leq 1\} \cup \Delta_{\Mot_n}
  \end{align*}
\end{proposition}
These characterisations will help us later when we consider generating pairs for
the congruences.

We are now ready to state the main theorem of this chapter, giving a full
description of the congruence lattice of $\Mot_n$.  Much of the work to prove
this has already been done, and the rest of this section will be devoted to
completing the proof.  Note that our main theorem requires $n \geq 2$; if
$n = 1$ then $\Mot_n$ has only $2$ elements, and its congruences are only
$\Delta_{\Mot_n}$ and $\nabla_{\Mot_n}$.

\begin{theorem}
  \label{thm:mn-congs}
  Let $\Mot_n$ be the Motzkin monoid, with $n \geq 2$.  The following hold:
  \begin{enumerate}[\rm(i)]
  \item The congruences of $\Mot_n$ are precisely
    $\{\delta_0, \delta_1, \lambda_0, \lambda_1, \rho_0, \rho_1, R_0, R_1,
    \ldots, R_n\}$;
  \item The congruence lattice of $\Mot_n$ is shown in Figure
    \ref{fig:mn-cong-lattice};
  \item Every congruence of $\Mot_n$ is principal;
  \item Each congruence $\sigma$ of $\Mot_n$ is generated by any single pair
    from $\sigma$ not contained in any congruence below $\sigma$ in the
    congruence lattice.
  \end{enumerate}
  \begin{proof}
    Let $\Gamma$ be the set of relations stated in (i).  That the relations in
    $\Gamma$ are congruences has already been established.  Table
    \ref{tab:mn-genpairs} summarises the conditions for a single pair in
    $\Mot_n \times \Mot_n$ to generate each congruence in $\Gamma$; it proves
    that every congruence in $\Gamma$ is principal, and since each pair in
    $\Mot_n \times \Mot_n$ satisfies one of the conditions, it proves that there
    are no other principal congruences.  Lemmas \ref{lem:mn-lattice-intra} and
    \ref{lem:mn-lattice-inter} show that the joins of these principal
    congruences are as shown in Figure \ref{fig:mn-cong-lattice}---proving
    (ii)---and therefore that $\Gamma$ is closed under taking joins, proving
    that $\Mot_n$ has no other congruences.  This completes the proof of (i) and
    (iii), and inspection of Table \ref{tab:mn-genpairs} establishes (iv).
  \end{proof}
\end{theorem}

% Show the lattice
\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    [cong/.style={circle, minimum size=0.9cm, draw}]
    \node[cong] (Rn) at ( 0,13) {$R_n$};
    \node[cong] (R2) at ( 0,10) {$R_2$};
    \node[cong] (R1) at ( 0, 8) {$R_1$};
    \node[cong] (l1) at (-3, 6) {$\lambda_1$};
    \node[cong] (R0) at ( 0, 6) {$R_0$};
    \node[cong] (r1) at ( 3, 6) {$\rho_1$};
    \node[cong] (l0) at (-3, 4) {$\lambda_0$};
    \node[cong] (d1) at ( 0, 4) {$\delta_1$};
    \node[cong] (r0) at ( 3, 4) {$\rho_0$};
    \node[cong] (d0) at ( 0, 2) {$\delta_0$};
    \node at (1.17,13) {$=\nabla_{\Mot_n}$};
    \node at (1.17, 2) {$=\Delta_{\Mot_n}$};
    \draw (d0)--(l0) (d0)--(r0) (l0)--(R0) (r0)--(R0);
    \fill[white] (-1.5,5)circle(.15) (+1.5,5)circle(.15);
    \draw (d0)--(d1) (l0)--(l1) (r0)--(r1) (R0)--(R1);
    \draw (d1)--(l1) (d1)--(r1) (l1)--(R1) (r1)--(R1);
    \draw (R1)--(R2);
    \draw[dashed] (R2)--(Rn);
  \end{tikzpicture}
  \caption{Congruence lattice of $\Mot_n$ (Hasse diagram)}
  \label{fig:mn-cong-lattice}
\end{figure}

% Proof of exhaustion: table of generating pairs, with references to
% propositions
For the rest of this section, we will state lemmas required to complete the
proof of Theorem \ref{thm:mn-congs}.  Firstly, we will focus on generating
pairs; we will consider a pair $(\alpha, \beta)$ and decide which principal
congruence it generates.  Our findings are summarised in Table
\ref{tab:mn-genpairs}.

\begin{table}[h]
  \renewcommand\arraystretch{1.0}
  \centering
  \begin{tabular}{| c | l | l |}
    \hline
    $(\alpha,\beta)^\sharp$ & $(\alpha,\beta) \in$ & Reference \\
    \hline
    $\delta_0$   & $\delta_0$
                 & Trivial                             \\
    $\delta_1$   & $\delta_1 \setminus \delta_0$
                 & Lemma \ref{lem:low-genpairs} (iii)  \\
    $\lambda_0$  & $\lambda_0 \setminus \delta_0$
                 & Lemma \ref{lem:low-genpairs} (i)    \\
    $\lambda_1$  & $\lambda_1 \setminus (\lambda_0 \cup \delta_1)$
                 & Lemma \ref{lem:high-genpairs} (i)   \\
    $\rho_0$     & $\rho_0 \setminus \delta_0$
                 & Lemma \ref{lem:low-genpairs} (ii)   \\
    $\rho_1$     & $\rho_1 \setminus (\rho_0 \cup \delta_1)$
                 & Lemma \ref{lem:high-genpairs} (ii)  \\
    $R_0$        & $R_0 \setminus (\lambda_0 \cup \rho_0)$
                 & Lemma \ref{lem:high-genpairs} (iii) \\
    $R_1$        & $R_1 \setminus (\lambda_1 \cup \rho_1 \cup R_0)$
                 & Lemma \ref{lem:high-genpairs} (iv)  \\
    $R_{k \geq 2}$ & $R_k \setminus R_{k-1}$
                 & Lemma \ref{lem:rees-genpairs}       \\
    \hline
  \end{tabular}
  \caption{Generating pairs for each congruence on $\Mot_n$}
  \label{tab:mn-genpairs}
\end{table}

\begin{lemma}
  \label{lem:low-genpairs}
  Let $\alpha,\beta \in \Mot_n$.  The following hold:
  \begin{enumerate}[\rm(i)]
  \item $\lambda_0 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in \lambda_0 \setminus \Delta$;
  \item $\rho_0 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in \rho_0 \setminus \Delta$;
  \item $\delta_1 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in \delta_1 \setminus \Delta$.
  \end{enumerate}
  \begin{proof}
    In each statement, the ``only if'' part is obvious.  We will prove (i) and
    observe that (ii) follows from a symmetric argument.  Then we will prove
    (iii) separately. % TODO: make this precise, with "duality"?

    For (i), let $(\alpha, \beta) \in \lambda_0 \setminus \Delta$, and let
    $\sigma = (\alpha, \beta)^\sharp$.  Since $\lambda_0$ is a congruence, we
    clearly have $\sigma \subseteq \lambda_0$; hence we have only to prove that
    $\lambda_0 \subseteq \sigma$.  First we require a special construction: if
    $\gamma \in I_0$, let $\gamma'$ be the unique bipartition in $I_0$ with
    trivial kernel and $\coker\gamma' = \coker\gamma$.  We claim that
    $(\gamma, \gamma') \in \sigma$ for any such $\gamma$.  This claim is proven
    by descending induction on $r$, the number of kernel-classes of $\gamma$: if
    $r = n$ then $\gamma = \gamma'$ and we are done.  Otherwise we have
    $r \leq n-1$, and we may write
    $\gamma = \bipart{c|c|c}{1-3}{A_1&\ldots&A_r}{B_1&\ldots&B_s}$.  Since
    $(\alpha,\beta) \in \lambda_0 \setminus \Delta$, Propisition
    \ref{prop:mn-cong-char} gives us $\rank\alpha = \rank\beta = 0$ and
    $\coker\alpha = \coker\beta$, but since $\alpha \neq \beta$ we must have
    $\ker\alpha \neq \ker\beta$.  Swapping $\alpha$ and $\beta$ if necessary,
    let us assume there exists some $(i,j) \in \ker\alpha \setminus \ker\beta$,
    and without loss of generality, assume $i < j$.  We will write
    $\bn \setminus \{i,j\}$ as $\{k_1, \ldots, k_{n-2}\}$.  Since $r \leq n-1$
    there exists some kernel block of $\gamma$ with 2 elements; let $m$
    be the lowest point in $\bn$ in a non-trivial kernel block, and without loss
    of generality, let us assume $m$ lies in $A_1$.  We can now define the
    bipartition $\tau = \bipart{c|c|c|c|c}{3-5}
    {m & p & A_2 & \ldots & A_r}
    {i & j & k_1 & \ldots & k_{n-2}}$, 
    where $A_1 = \{m, p\}$.
    We observe that $\tau \alpha \gamma = \gamma$ and
    $\tau \beta \gamma = \bipart{c|c|c|c|c}{1-5}
    {m & p & A_2 & \ldots & A_r}
    {B_1 & B_2 & B_3 & \ldots & B_s}$.
    Since $\sigma$ is left- and right-compatible, we have
    $\gamma = \tau\alpha\gamma \mathrel\sigma \tau\beta\gamma$.  Hence $\gamma$
    is $\sigma$-related to $\tau\beta\gamma$, a bipartition with rank $0$, the
    same cokernel as $\gamma$, and $r+1$ kernel classes.  Applying the same
    process inductively, with $\tau\beta\gamma$ in place of $\gamma$, implies a
    chain of $\sigma$-relations which relate $\gamma$ to a bipartition with rank
    $0$, the same cokernel as $\gamma$, and $n$ kernel classes---that is,
    $\gamma'$.  This proves the claim that $(\gamma, \gamma') \in \sigma$.

    To return to the proof that $\lambda_0 \subseteq \sigma$, let
    $(\mu, \nu) \in \lambda_0$ be arbitrary.  If $\mu = \nu$ then certainly
    $(\mu, \nu) \in \sigma$, so let us assume $\mu \neq \nu$.  By Proposition
    \ref{prop:mn-cong-char} we must have $\rank\mu = \rank\nu = 0$ and
    $\coker\mu = \coker\nu$, so we have $\mu' = \nu'$.  Hence, by the above
    claim, we have $\mu \mathrel\sigma \mu' = \nu' \mathrel\sigma \nu$,
    completing (i).  Observe that (ii) follows by a similar argument.

    To prove (iii), let $(\alpha,\beta)\in\delta_1\setminus\Delta$ as stated,
    and let $\sigma = (\alpha,\beta)^\sharp$.  Clearly
    $\sigma \subseteq \delta_1$.  To prove that $\delta_1 \subseteq \sigma$ is
    harder.  Since $(\alpha,\beta) \in \delta_1 \setminus \Delta$, $\alpha$ and
    $\beta$ must each have rank $0$ or $1$, and have the same kernel and
    cokernel, but be distinct.  Since there is only one bipartition of rank $0$
    with a given kernel and cokernel, they cannot both have rank $1$.  Hence,
    swapping $\alpha$ and $\beta$ if necessary, we may assume that
    $\rank(\alpha)=1$, with transversal $\{i,j'\}$ and we can write
    $\alpha=\bipart{c|c|c|c}{2-4}
    {i & A_1 & \cdots & A_r}{j & B_1 & \cdots & B_s}$.
    Then $\beta$ has one of the following four forms, where without loss of
    generality, additional labelled elements are assumed to be from $A_1$:
    \begin{enumerate}[\rm(a)]
    \item $\beta = \bipart{c|c|c|c|c}{1-5}
      {i & A_1 & A_2 & \cdots & A_r}{j & B_1 & B_2 & \cdots & B_s}$,
      so that $\beta = \widehat\alpha$;
    \item $\beta = \bipart{c|c|c|c|c}{2-5}
      {k & i & A_2 & \cdots & A_r}{j & B_1 & B_2 & \cdots & B_s}$,
      replacing $i$ with $k$, a different point from $\bn$;
    \item $\beta = \bipart{c|c|c|c|c}{2-5}
      {i & A_1 & A_2 & \cdots & A_r}{l & j & B_2 & \cdots & B_s}$,
      replacing $j'$ with $l'$, a different point from $\bn'$;
    \item $\beta = \bipart{c|c|c|c|c}{2-5}
      {k & i & A_2 & \cdots & A_r}{l & j & B_2 & \cdots & B_s}$,
      with a completely new transversal.
    \end{enumerate}
    Now, let us denote by $\tau_{ab}$ the bipartition $(a, b')^e$ in $\Mot_n$
    which has just one non-trivial block $\{a,b'\}$.  We will use the
    bipartitions $\tau_{ii}$ and $\tau_{jj}$. In all four cases above, we have
    $\tau_{ii}\alpha\tau_{jj}= \tau_{ij}$ and
    $\tau_{ii}\beta\tau_{jj}= \tau_\varnothing$, the bipartition consisting
    entirely of singletons.  Since $\alpha \mathrel\sigma \beta$, we also have
    $\tau_{ij} = \tau_{ii}\alpha\tau_{jj} \mathrel\sigma
    \tau_{ii}\beta\tau_{jj}= \tau_\varnothing$, so
    $\tau_{ij} \mathrel\sigma \tau_\varnothing$.

    Next, let $\gamma$ be an arbitrary bipartition in $\Mot_n$ with rank $1$.
    We can write
    $\gamma = \bipart{c|c|c|c}{2-4}
    {c & C_1 & \cdots & C_t}{d & D_1 & \cdots & D_u}$,
    where $\{c,d'\}$ is the one transversal.  Let us write
    $\bn \setminus \{i\} = \{i_1, \ldots, i_{n-1}\}$ and
    $\bn \setminus \{j\} = \{j_1, \ldots, j_{n-1}\}$.  Then we can define two
    new bipartitions:
    $\overline\gamma = \bipart{c|c|c|c}{2-4}
    {c & C_1 & \cdots & C_t}{i & i_1 & \cdots & i_{n-1}}$ and
    $\underline\gamma = \bipart{c|c|c|c}{2-4}
    {j & j_1 & \cdots & j_{n-1}}{d & D_1 & \cdots & D_u}$.
    We can see that $\gamma = \overline\gamma \tau_{ij} \underline\gamma$ and
    $\widehat\gamma = \overline\gamma \tau_\varnothing \underline\gamma$, so
    we have $\gamma \mathrel\sigma \widehat\gamma$ for any $\gamma$ of rank
    $1$.  The same statement is also true for $\gamma$ of rank $0$, since
    $\gamma = \widehat\gamma$.

    To prove that $\delta_1 \subseteq \sigma$, let $(\mu, \nu) \in \delta_1$ be
    arbitrary.  Each of $\mu$ and $\nu$ must have rank $0$ or $1$, and they must
    have the same kernel and cokernel.  Hence we have
    $\mu \mathrel\sigma \widehat\mu = \widehat\nu \mathrel\sigma \nu$, so
    $(\mu, \nu) \in \sigma$, completing the proof of (iii).
  \end{proof}
\end{lemma}

\begin{lemma}
  \label{lem:high-genpairs}
  Let $\alpha,\beta \in \Mot_n$.  The following hold:
  \begin{enumerate}[\rm(i)]
  \item $\lambda_1 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in \lambda_1 \setminus (\lambda_0 \cup \delta_1)$;
  \item $\rho_1 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in \rho_1 \setminus (\rho_0 \cup \delta_1)$;
  \item $R_0 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in R_0 \setminus (\lambda_0 \cup \rho_0)$;
  \item $R_1 = (\alpha, \beta)^\sharp$ if and only if
    $(\alpha,\beta) \in R_1 \setminus (\lambda_1 \cup \rho_1 \cup R_0)$.
  \end{enumerate}
  \begin{proof}
    In each statement, as in the previous lemma, the ``only if'' part is
    obvious; we just need to consider the left-to-right implications.  First we
    will prove (i) and observe that (ii) follows from a symmetric argument.
    Then we will prove (iii) and (iv) separately.

    For (i), start by supposing
    $(\alpha, \beta) \in \lambda_1 \setminus (\lambda_0 \cup \delta_1)$, as in
    the premise.  To be outside $\lambda_0$, either $\alpha$ or $\beta$ must
    have rank $1$---without loss of generality, assume $\rank(\alpha)=1$.  We
    may therefore write
    $\alpha=\bipart{c|c|c|c}{2-4}{i&A_1&\cdots&A_r}{j&B_1&\cdots&B_s}$.  Now,
    since $\rank\beta \leq 1$ and $\coker\alpha = \coker\beta$, we may write
    $\beta$ in one of the following ways.
    \begin{enumerate}[\rm(a)]
    \item (c) $\beta = \bipart{c|c|c|c|c}{1-5}
      {C_0 & C_1 & C_2 & \cdots & C_t}{j & B_1 & B_2 & \cdots & B_s}$;
    \item (a $=$) $\beta = \bipart{c|c|c|c|c}{2-5}
      {i & C_1 & C_2 & \cdots & C_t}{j & B_1 & B_2 & \cdots & B_s}$;
    \item (a $\neq$) $\beta = \bipart{c|c|c|c|c}{2-5}
      {k & C_1 & C_2 & \cdots & C_t}{j & B_1 & B_2 & \cdots & B_s}$,
      for some $k \neq i$;
    \item (b intersect) $\beta = \bipart{c|c|c|c|c}{2-5}
      {i & C_1 & C_2 & \cdots & C_t}{l & j & B_2 & \cdots & B_s}$,
      for some $l \neq j$;
    \item (b no intersect) $\beta = \bipart{c|c|c|c|c}{2-5}
      {k & C_1 & C_2 & \cdots & C_t}{l & j & B_2 & \cdots & B_s}$,
      for some $k \neq i$ and $l \neq j$.
    \end{enumerate}
    Since $(\alpha,\beta) \notin \delta_1$, we have
    $\coker\alpha \neq \coker\beta$.  Let
    $\gamma = \bipart{c|c|c|c}{1-4}
    {j & B_1 & \cdots & B_s}{j & B_1 & \cdots & B_s}$.  Then
    $(\alpha\gamma, \beta\gamma) \in (\alpha,\beta)^\sharp$, with
    $\alpha\gamma = \bipart{c|c|c|c}{1-4}
    {i & A_1 & \cdots & A_r}{j & B_1 & \cdots & B_s}$ and
    $\beta\gamma = \bipart{c|c|c|c}{1-4}
    {C_0 & C_1 & \cdots & C_t}{j & B_1 & \cdots & B_t}$.  In particular,
    since $\alpha \neq \beta$, we find $\alpha\gamma \neq \beta\gamma$, and
    therefore $(\alpha\gamma, \beta\gamma) \in \lambda_0 \setminus \Delta$, so
    Lemma \ref{lem:low-genpairs} (i) gives us
    $\lambda_0=(\alpha\gamma, \beta\gamma)^\sharp
    \subseteq (\alpha, \beta)^\sharp$.
    Since $\lambda_1 = \delta_1 \vee \lambda_0$ (by Lemma
    \ref{lem:mn-lattice-inter} below), we need only show that $\delta_1
    \subseteq (\alpha,\beta)^\sharp$, and (i) is complete.
    To do this, we will consider the cases (a)--(e) separately.

    Firstly, assume (c) holds.  We have
    $(\alpha\alpha^*)\beta = \widehat\alpha$, and Lemma
    \ref{lem:low-genpairs} (iii) gives
    $\delta_1 = (\alpha, \widehat\alpha)^\sharp = (\alpha\alpha^*\alpha,
    \alpha\alpha^*\beta)^\sharp \subseteq (\alpha,\beta)^\sharp$, so
    $\delta_1 \subseteq (\alpha, \beta)^\sharp$.

    Next, suppose (a=) holds.
    Since $\alpha \neq \beta$, the blocks $A_1$ to $A_r$ cannot be the same as
    the blocks $C_1$ to $C_t$.  Hence, swapping $\alpha$ and $\beta$ if
    necessary, let $(a_1,a_2) \in \ker\alpha \setminus \ker\beta$.  Now let
    $\bn \setminus \{i,a_1,a_2\} = \{i_1, \ldots, i_{n-3}\}$, let
    $\tau=\bipart{c|c|c|c|c}{2-5}
    {a_1 & i,a_2 & i_1 & \ldots & i_{n-3}}
    {a_1 & i,a_2 & i_1 & \ldots & i_{n-3}}$,
    and note that
    $\tau\alpha = \bipart{c|c|c|c|c}{2-5}
    {a_1 & i,a_2 & i_1 & \ldots & i_{n-3}}{B_0 & B_1 & B_2 & \ldots & B_s}$ but
    $\tau\beta = \bipart{c|c|c|c|c}{1-5}
    {a_1 & i,a_2 & i_1 & \ldots & i_{n-3}}{B_0 & B_1 & B_2 & \ldots & B_s}$.
    Hence we have $(\tau\alpha,\tau\beta) \in \delta_1 \setminus \Delta$, so
    Lemma \ref{lem:low-genpairs} (iii) gives us
    $\delta_1 = (\tau\alpha,\tau\beta)^\sharp \subseteq (\alpha,\beta)^\sharp$.

    Next, suppose (a neq) holds.  Let $\tau = (i,i')^e$, the
    bipartition containing just one non-trivial block $\{i,i'\}$, let
    $\bn \setminus \{i\}=\{i_1,\ldots,i_{n-1}\}$, and note that
    $\tau\alpha = \bipart{c|c|c|c}{2-4}
    {i & i_1 & \cdots & i_{n-1}}{j & B_1 & \cdots & B_s}$ but
    $\tau\beta = \bipart{c|c|c|c}{1-4}
    {i & i_1 & \cdots & i_{n-1}}{j & B_1 & \cdots & B_s}$.
    Again we have $(\tau\alpha,\tau\beta) \in \delta_1 \setminus \Delta$, so by
    Lemma \ref{lem:low-genpairs} (iii) we have
    $\delta_1 = (\alpha\tau,\beta\tau)^\sharp \subseteq (\alpha,\beta)^\sharp$.

    Next, suppose (b intersect) holds.
    Again let $\bn\setminus\{i\}=\{i_1,\ldots,i_{n-1}\}$, let
    $\tau=\bipart{c|c|c|c}{2-4}
    {i & A_1 & \cdots & A_r}{i & i_1 & \cdots & i_{n-1}}$, and note that
    $\tau\alpha = \alpha $ and
    $\tau\beta = \bipart{c|c|c|c|c}{2-5}
    {i & A_1 & A_2 & \cdots & A_r}{l & j & B_2 & \cdots & B_s}$.
    We have $(\tau\alpha,\tau\beta) \in \delta_1 \setminus \Delta$, so by
    Lemma \ref{lem:low-genpairs} (iii) we again have
    $\delta_1=(\alpha\tau, \beta\tau)^\sharp\subseteq(\alpha,\beta)^\sharp$.

    Finally, suppose (b no intersect) holds.
    Let $\bn\setminus\{i,k\}=\{k_1,\ldots,k_{n-2}\}$, let
    $\tau=(i \to k,i \to k)$, and note that
    $\tau\alpha=\bipart{c|c|c|c|c}{2-5}
    {i & k & k_1 & \ldots & k_{n-2}}
    {j & l & B_2 & \ldots & B_s}$
    and
    $\tau\beta=\bipart{c|c|c|c|c}{2-5}
    {k & i & k_1 & \ldots & k_{n-2}}
    {l & j & B_2 & \ldots & B_s}$
    We have $(\tau\alpha,\tau\beta) \in \delta_1 \setminus \Delta$, so again by
    Lemma \ref{lem:low-genpairs} (iii) we have
    $\delta_1 = (\tau\alpha, \tau\beta)^\sharp \subseteq (\alpha,\beta)^\sharp$.

    We have now considered all 5 cases, and shown that we always have
    $\delta \subseteq (\alpha, \beta)^\sharp$.  This completes the proof of
    (i).  Note that (ii) follows by a symmetric argument.

    For (iii), suppose $(\alpha,\beta)\in R_0\setminus(\rho_0\cup\lambda_0)$.
    Since $\rank\alpha = \rank\beta = 0$, we may write
    $\alpha=\bipart{c|c|c}{1-3}{A_1 & \cdots & A_r}{B_1 & \cdots & B_s}$ and
    $\beta=\bipart{c|c|c}{1-3}{C_1 & \cdots & C_t}{D_1 & \cdots & D_u}$.
    % noting that $\ker(\alpha)\not=\ker(\beta)$ and
    % $\coker(\alpha)\not=\coker(\beta)$.
    By Lemma \ref{lem:mn-lattice-intra} (i) below, we have
    $R_0 = \lambda_0\vee\rho_0$, so we will prove $(\alpha,\beta)^\sharp$
    contains $R_0$ by showing that it contains both $\lambda_0$ and $\rho_0$.
    Let $\gamma = \bipart{c|c|c}{1-3}{A_1 & \cdots & A_r}{D_1 & \cdots & D_u}$.
    This gives us
    $(\alpha,\gamma) = (\alpha\gamma,\beta\gamma) \in \lambda_0\setminus\Delta$,
    so by Lemma \ref{lem:low-genpairs} (i) we have
    $\lambda_0 = (\gamma,\beta)^\sharp \subseteq (\alpha, \beta)^\sharp$.  By a
    similar argument we have
    $\rho_0 = (\alpha,\gamma)^\sharp \subseteq (\alpha,\beta)^\sharp$, and hence
    $R_0 \subseteq (\alpha,\beta)^\sharp$, completing (iii).

    Finally, for (iv), suppose
    $(\alpha,\beta) \in R_1 \setminus (\lambda_1 \cup \rho_1 \cup R_0)$, as in
    the premise.  Since the pair is in $R_1$, the elements' ranks must both be
    at most $1$; but since it is not in $R_0$, at least one must be of rank $1$
    (without loss of generality, assume $\alpha$).  Since the pair is in neither
    $\lambda$ nor $\rho$, we also know that $\ker\alpha \neq \ker\beta$ and
    $\coker\alpha \neq \coker\beta$.
    Hence we can write
    $\alpha = \bipart{c|c|c|c}{2-4}
    {i & A_1 & \cdots & A_r}{j & B_1 & \cdots & B_s}$, and
    $\beta = \bipart{c|c|c|c}{2-4}
    {k & C_1 & \cdots & C_t}{l & D_1 & \cdots & D_u}$ or
    $\beta = \bipart{c|c|c|c}{1-4}
    {k & C_1 & \cdots & C_t}{l & D_1 & \cdots & D_u}$.  Now, as in (iii),
    since $R_1 = \lambda_1 \vee \rho_1$, by Lemma \ref{lem:mn-lattice-intra}, we
    prove that $(\alpha,\beta)^\sharp = R_1$ by showing that
    $(\alpha,\beta)^\sharp$ contains $\lambda_1$ and $\rho_1$.  We proceed by
    solving three cases separately.  One of the following three statements about
    $\beta$ must hold:
    \begin{enumerate}[\rm(a)]
      \setcounter{enumi}{5}
    \item $\rank(\beta) = 0$;
    \item $\rank(\beta) = 1$ and $j = l$;
    \item $\rank(\beta) = 1$ and $j \neq l$.
    \end{enumerate}

    First, suppose (f) or (g) holds.  Let
    $\gamma = \bipart{c|c|c|c}{2-4}
    {j & B_1 & \cdots & B_s}{j & B_1 & \cdots & B_s}$.  Certainly we have
    $\alpha\gamma = \alpha$.  To find $\beta\gamma$ we separate into two cases:
    $\beta\gamma = \bipart{c|c|c|c}{1-4}
    {k & C_1 & \cdots & C_t}{j & B_1 & \cdots & B_s}$---case (f)---or
    $\beta\gamma = \bipart{c|c|c|c}{2-4}
    {k & C_1 & \cdots & C_t}{j & B_1 & \cdots & B_s}$---case (g).
    In either case, using (i), we have
    $\lambda_1 = (\alpha\gamma, \beta\gamma)^\sharp
    \subseteq (\alpha,\beta)^\sharp$, completing this case.

    Next, assume (h) holds.
    Write $\bn \setminus \{j\} = \{j_1, \ldots, j_{n-1}\}$, and let
    $\tau = (j,j')^e$, the bipartition whose only non-trivial block is
    $\{j, j'\}$.  Then we have
    $\alpha\tau = \bipart{c|c|c|c}{2-4}
    {i & A_1 & \cdots & A_r}{j & j_1 & \cdots & j_{n-1}}$ and
    $\beta\tau = \bipart{c|c|c|c}{1-4}
    {k & C_1 & \cdots & C_t}{j & j_1 & \cdots & j_{n-1}}$.
    Using (i) again gives us
    $\lambda_1 = (\alpha\tau, \beta\tau)^\sharp
    \subseteq (\alpha,\beta)^\sharp$,
    as required.  This completes the proof that
    $\lambda_1 \subseteq (\alpha,\beta)^\sharp$.  The proof that
    $\rho_1 \subseteq (\alpha,\beta)^\sharp$ is similar.  Hence $R_0 \subseteq
    (\alpha,\beta)^\sharp$, and the proof of (iv) is complete.
  \end{proof}
\end{lemma}

\begin{lemma}
  \label{lem:rees-genpairs}
  Let $\alpha,\beta \in \Mot_n$, and $k \in \{2, \ldots, n\}$.  We have
  $R_k = (\alpha, \beta)^\sharp$ if and only if
  $(\alpha, \beta) \in R_k \setminus R_{k-1}$.
  \begin{proof}

  \end{proof}
\end{lemma}

Now that we have described all the principal congruences of $\Mot_n$, we turn
our attention to the join of two congruences.  Since any semigroup congruence is
a join of principal congruences, this will allow us to prove that we have found
every possible congruence.

\begin{lemma}
  \label{lem:mn-lattice-intra}
  Let $i \in \{0, 1\}$.  In $\Mot_n$, we have $\lambda_i \cap \rho_i = \delta_i$
  and $\lambda_i \vee \rho_i = R_i$.
  \begin{proof}

  \end{proof}
\end{lemma}

\begin{lemma}
  \label{lem:mn-lattice-inter}
  The following hold in $\Mot_n$:
  \begin{enumerate}[\rm(i)]
    \begin{multicols}{2}
    \item $\lambda_0 \subseteq \lambda_1$, $\rho_0 \subseteq \rho_1$, and
      $\delta_0 \subseteq \delta_1$;
    \item $\lambda_0 \cap \rho_1 = \rho_0 \cap \lambda_1 = \delta_0$;
    \item $\lambda_0 \vee \rho_1 = \rho_0 \vee \lambda_1 = R_1$;
    \item $\lambda_0 \cap \delta_1 = \rho_0 \cap \delta_1 = \delta_0$;
    \item $\lambda_0 \vee \delta_1 = \lambda_1$ and
      $\rho_0 \vee \delta_1 = \rho_1$;
    \item $R_0 \cap \delta_1 = \delta_0$ and $R_0 \vee \delta_1 = R_1$.
    \end{multicols}
  \end{enumerate}
  \begin{proof}
    We can see (i) and (ii) immediately from the descriptions of the congruences
    in Proposition \ref{prop:mn-cong-char}.  The same proposition, and the fact
    that bipartitions of rank $0$ are equal if they have the same kernel and
    cokernel, also give us (iv) and the first part of (vi).
  \end{proof}
\end{lemma}

These two lemmas are sufficient to construct the congruence lattice in Figure
\ref{fig:mn-cong-lattice}, and to complete the proof of Theorem
\ref{thm:mn-congs}.

\section{Other monoids}
\label{sec:motzkin-other}
