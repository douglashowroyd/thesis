\chapter{Converting between different congruence representations}
\label{chap:converting}

A congruence is a binary relation, and therefore is formally described as a set
of pairs---a subset of $S \times S$.  In a computational setting, it is worth
thinking about how a congruence could be stored.

One approach to storing a congruence $\rho$ on a semigroup $S$ is simply to
store every one of the pairs in $\rho$.  In principle, it is possible to store
$\rho$ in this way if and only if $S$ is finite.  However, this could well use a
lot of storage---even the trivial congruence would use $O(|S|)$ space, and in
general a congruence could even use $O(|S|^2)$ space.

% TODO: reference to "most congs don't need many generating pairs" section
In Chapter \ref{chap:pairs} we looked in detail at how a congruence can be
represented by a set of generating pairs.  As we found there, a congruence can
be described by a subset $\mathbf{R} \subseteq \rho$, which in many cases can be
very small.  This is one very generic way of representing congruences, in two
senses: firstly that it can be used for any finite semigroup; and secondly that
it can be used for left and right congruences.

However, there are other ways to view congruences in certain circumstances,
either based on a special property of the semigroup in question, or based on
properties of some individual congruences.  In this chapter, we will describe
some important ways of representing congruences, and then consider ways of
converting one to another.

\section{Ways of representing a congruence}

\subsection{Generating pairs}
Recall that a congruence $\rho$ on a semigroup $S$ can be stored using
a subset of the pairs in $\rho$.  If $\mathbf{R}$ is a subset of $S \times S$,
then we can say that $\mathbf{R}$ \textit{generates} a congruence.  The
congruence \textit{generated by} $\mathbf{R}$ is defined as the least congruence
on $S$ containing all the pairs in $\mathbf{R}$; equivalently, it is defined as
the intersection of all congruences on $S$ containing all the pairs in
$\mathbf{R}$.  It is denoted by $\mathbf{R}^\sharp$ (see Theorem
\ref{thm:rsharp}).  We have similarly defined the left congruence generated by
$\mathbf{R}$ (denoted by $\mathbf{R}^\triangleleft$), and the right congruence
generated by $\mathbf{R}$ (denoted by $\mathbf{R}^\triangleright$).
A full explanation of how generating pairs can be used to represent congruences
is given in Section \ref{sec:intro-gen-pairs}, an approach for computing
properties of congruences using their generating pairs is given in Chapter
\ref{chap:pairs}.

Given a set of pairs $\mathbf{R}$, we may wish to produce the congruence
$\mathbf{R}^\sharp$ and represent it using one of the other methods described in
this chapter.  It is of course possible to calculate the set of all pairs in
$\mathbf{R}^\sharp$ and convert that to the other representation; however, in
order to find other representations with as little work as possible, it is
desirable to use the pairs in $\mathbf{R}$ directly, calculating as few extra
pairs as possible.  Conversely, if we wish to convert another representation for
a congruence $\rho$ to a set of generating pairs, it is desirable to find as
small a set of pairs as possible.  When converting between generating pairs and
other representations, these will be the goals.

\subsection{Groups: normal subgroups}
\label{sec:normal-subgroups}

In group theory, it is unusual to encounter discussion of congruences.  This is
because a group's congruences are closely related to another structure, its
normal subgroups, and any questions we could ask about a group's congruences are
easily described using normal subgroups instead.  Recall that a subgroup $N$ of
a group $G$ is \textit{normal} if and only if $g^{-1}ng \in N$ for all $g \in G$
and $n \in N$; recall also that a \textit{coset} of $N$ is the set $Ng$ or $gN$
for some $g \in G$, and that $Ng=gN$ if $N$ is normal.  The following theorem
shows how the normal subgroups and congruences of a congruence are in bijective
correspondence.

\begin{theorem}
  \label{thm:normal-subgroups}
  Let $G$ be a group.  If $\rho$ is a congruence on $G$, then the $\rho$-class
  containing the identity is a normal subgroup of $G$.

  Conversely, if $N$ is a normal subgroup of $G$, then its cosets are the
  classes of a congruence on $G$.

  \begin{proof}
    First, let $\rho$ be a congruence on $G$, and let $I$ be the $\rho$-class
    containing the identity $1$.  First we show that $I$ is a subgroup: if
    $a,b \in I$ then $ab ~\rho~ 11 = 1$, so $ab \in I$.
    Furthermore, we have $(a,1) \in \rho$, so
    $(aa^{-1}, 1a^{-1}) = (1, a^{-1}) \in \rho$, and so $a^{-1} \in I$, and so
    $I$ is a subgroup.  To show $I$ is normal, let $g \in G$ and $i \in I$.
    Observe that $g^{-1}ig ~\rho~ g^{-1}1g = g^{-1}g = 1$, so $g^{-1}ig \in I$,
    as required.

    To show the converse, let $N$ be a normal subgroup of $G$, and let $\nu$ be
    the equivalence on $G$ whose classes are the cosets of $N$.  If
    $(x,y), (s,t) \in \nu$, then $Nx=Ny$ and $sN=tN$.  Hence
    $Nxs=Nys=ysN=ytN=Nyt$, so we have $(xs,yt) \in \nu$, meaning that $\nu$ is
    a congruence as required.
  \end{proof}
\end{theorem}

This theorem means that any information which can be taken from a congruence can
instead be taken from a normal subgroup, and so congruences on a group need
never be studied directly.  We even have the fortunate property that the
containment of normal subgroups follows the containment of the corresponding
congruences.  The other structures discussed in this section represent
congruences on other categories of semigroup in a similar way.



\subsection{Completely (0-)simple semigroups: linked triples}
\label{sec:linked-triples}

There is a special way of describing a congruence on a completely simple or
completely 0-simple semigroup: using a linked triple.  We will start by
explaining the terms completely simple and completely 0-simple, then define a
semigroup's linked triples and explain how they are related to its congruences.

\begin{definition}
  \label{def:zerosimple}
  A semigroup $S$ is:
  \begin{itemize}
  \item \textbf{simple} if its only ideal is $S$;
  \item \textbf{0-simple} if it has a zero, and its only ideals are $S$ and
    $\{0\}$.
  \end{itemize}
\end{definition}

Simple and 0-simple semigroups are closely related.  Note that if $S$ is a
simple semigroup, then $S^0$, the semigroup created by appending a zero element
to $S$, is 0-simple.

Next, we consider a slightly stronger condition.

\begin{definition}
  \label{def:completelyzerosimple}
  A semigroup is:
  \begin{itemize}
  \item \textbf{completely simple} if it is simple and contains a primitive
    idempotent;
  \item \textbf{completely 0-simple} if it is 0-simple and contains a primitive
    idempotent.
  \end{itemize}
  An idempotent $p \in S$ is \textbf{primitive} if it is non-zero and there is
  no other non-zero idempotent $i \in S$ such that $ip = pi = i$.
  %TODO: rephrase in terms of partial ordering of idempotents?
\end{definition}

Definitions \ref{def:zerosimple} and \ref{def:completelyzerosimple} are
equivalent for finite semigroups---that is to say, a finite semigroup is
completely simple if and only if it is simple, and it is completely 0-simple if
and only if it is 0-simple.  Some of the conversions described in this chapter
will be applicable only to finite semigroups, and in those circumstances we will
refer to \textit{finite simple} or \textit{finite 0-simple} semigroups, knowing
that these are completely simple or completely 0-simple, respectively.
Note that a finite semigroup is simple if and only if it is $\JJ$-trivial.
%TODO: only finite?

Completely simple and completely 0-simple semigroups have a strong and useful
isomorphism property, which allows us to say a great deal about their structure
and, in particular, their congruences.  We will consider first the more
complicated case, that of completely 0-simple semigroups, and then we will go on
to explain the easier case, completely simple semigroups.

\begin{definition}
  \label{def:rzms}
  A \textbf{Rees 0-matrix semigroup} $\mathcal{M}^0[T;I,\Lambda;P]$ is the set
  $$(I \times T \times \Lambda) \cup \{0\}$$
  with multiplication given by
  $$(i,a,\lambda) \cdot (j,b,\mu) = \left\{
    \begin{array}{l l}
      (i,ap_{\lambda j}b, \mu) & \text{if~} p_{\lambda j} \neq 0, \\
      0 & \text{otherwise,}
    \end{array}
  \right.$$
  where
  \begin{itemize}
  \item $T$ is a semigroup,
  \item $I$ and $\Lambda$ are index sets,
  \item $P$ is a $|\Lambda| \times |I|$ matrix with entries $(p_{\lambda
      i})_{\lambda \in \Lambda, i \in I}$
    taken from $T^0$,
  \item $0x=x0=0$ for all $x$ in the semigroup.
  \end{itemize}
  \cite[\S 3.2]{howie}
\end{definition}

We will require a certain property of the matrix $P$, which we should define
first.  We will call a matrix $P$ \textbf{regular} if it contains at least one
non-zero entry in each row and each column.

The following theorem shows how we can use Rees 0-matrix semigroups to classify
completely 0-simple semigroups.

\begin{theorem}[Rees]
  \label{thm:rees}
  Every completely 0-simple semigroup is isomorphic to a Rees 0-matrix semigroup
  $\mathcal{M}^0[G;I,\Lambda;P]$, where $G$ is a group and $P$ is regular.
  Conversely, every such Rees 0-matrix semigroup is completely 0-simple.
  \begin{proof}
    Theorem 3.2.3 in \cite[p.72-75]{howie}.
  \end{proof}
\end{theorem}

Now we can describe any finite 0-simple semigroup as its isomorphic Rees
0-matrix semigroup.  Hence we can restrict our further investigations just to
this type of semigroup.  From now on, when we see a Rees 0-matrix semigroup over
$G$, we will assume that $G$ is a group.  Hence ``a finite 0-simple Rees
0-matrix semigroup $\mathcal{M}^0[G;I,\Lambda;P]$'' refers to a finite 0-simple
Rees 0-matrix semigroup over a group, with a regular matrix $P$.

Next we consider the congruences of a finite 0-simple semigroup.

\begin{definition}
  \label{def:linked-triple}
  Let $S$ be a completely 0-simple Rees 0-matrix semigroup
  $\mathcal{M}^0[G;I,\Lambda;P]$.  A \textbf{linked triple} on $S$ is a
  triple $$(N,\mathcal{S},\mathcal{T})$$ consisting of a normal subgroup
  $N \trianglelefteq G$, an equivalence relation $\mathcal{S}$ on $I$ and an
  equivalence relation $\mathcal{T}$ on $\Lambda$, such that the following are
  satisfied:
  \begin{enumerate}
  \item $\mathcal{S} \subseteq \varepsilon_I$, where $\varepsilon_I =
    \left\{(i,j) \in I \times I\, \middle|\, \forall \lambda \in \Lambda:
      p_{\lambda i}=0 \iff p_{\lambda j}=0 \right\}$,
  \item $\mathcal{T} \subseteq \varepsilon_\Lambda$, where $\varepsilon_\Lambda
    = \left\{(\lambda,\mu) \in \Lambda \times \Lambda\, \middle|\, \forall i \in
      I: p_{\lambda i}=0 \iff p_{\mu i}=0 \right\}$,
  \item For all $i,j \in I$ and $\lambda, \mu \in \Lambda$ such that
    $p_{\lambda i}, p_{\lambda j}, p_{\mu i}, p_{\mu j} \neq 0$ and either
    $(i,j) \in \mathcal{S}$ or $(\lambda,\mu) \in \mathcal{T}$, we have that
    $q_{\lambda \mu i j} \in N$, where
    $$q_{\lambda \mu i j} = p_{\lambda i} p_{\mu i}^{-1} p_{\mu j} p_{\lambda
      j}^{-1}.$$
  \end{enumerate}
  \cite[p.86]{howie}
\end{definition}

We can associate the linked triples of a finite 0-simple semigroup with its
non-universal congruences.

\begin{theorem}
  \label{thm:linked-triple}
  Let $S$ be a completely 0-simple Rees 0-matrix semigroup.  There exists a
  bijection $\Gamma$ from the non-universal congruences on $S$ to the linked
  triples on $S$.
\end{theorem}

This theorem shows us an alternative way to look at congruences on completely
0-simple semigroups, just as normal subgroups show us an alternative way to look
at congruences on groups.  However, in order to use this at all in a
computational setting, we must have a concrete function $\Gamma$ which we can
use to convert a congruence to a linked triple and back again, rather than just
the knowledge that such a function exists.  We define the function $\Gamma$ as
follows.

\begin{definition}
  Let $S$ be a completely 0-simple Rees 0-matrix semigroup
  $\mathcal{M}^0[G;I,\Lambda;P]$, and let $\rho$ be a non-universal congruence
  on $S$.

  We define a relation $\mathcal{S}_\rho \subseteq I \times I$ by the rule that
  $(i,j) \in \mathcal{S}_\rho$ if and only if $(i,j) \in \varepsilon_I$ and
  $$(i, p_{\lambda i}^{-1}, \lambda) ~\rho~ (j, p_{\lambda j}^{-1}, \lambda)$$
  for all $\lambda \in \Lambda$ such that $p_{\lambda i} \neq 0$ (and hence
  $p_{\lambda j} \neq 0$).

  Similarly, we define a relation
  $\mathcal{T}_\rho \subseteq \Lambda \times \Lambda$ by the rule that
  $(\lambda,\mu) \in \mathcal{T}_\rho$ if and only if
  $(\lambda,\mu) \in \varepsilon_\Lambda$ and
  $$(i, p_{\lambda i}^{-1}, \lambda) ~\rho~ (i, p_{\mu i}^{-1}, \mu)$$
  for all $i \in I$ such that $p_{\lambda i} \neq 0$ (and hence
  $p_{\mu i} \neq 0$).

  Finally, we define a normal subgroup $N_\rho \trianglelefteq G$ as follows.
  First, let $1_\Lambda \in \Lambda$ be the top row of the matrix $P$.  Since
  $P$ is regular, row $1_\Lambda$ must contain a non-zero entry.  Let
  $1_I \in I$ be the first column such that $p_{1_\Lambda 1_I} \neq 0$.

  Now let
  $$N_\rho = \{a \in G ~|~ (1_I,a,1_\Lambda) ~\rho~ (1_I, 1_G, 1_\Lambda),$$
  where $1_G$ is the identity in the group $G$.

  The \textbf{linked triple function} of $S$ is the function
  $$\Gamma: \rho \mapsto (N_\rho, \mathcal{S}_\rho, \mathcal{T}_\rho),$$
  which maps any non-universal congruence onto a triple with the entries defined
  above.
\end{definition}

While in this paper we are concentrating on finite 0-simple semigroups, it
should be noted that a very similar representation exists for finite
\emph{simple} semigroups (Rees matrix semigroups), and the functions described
operate in almost exactly the same way, except for the removal of complications
related to the zero element.  In this system, the universal congruence can also
be represented by a linked triple, namely $(G, I \times I, \Lambda \times
\Lambda)$. \cite[p.90-91]{howie}

Since the theory is so similar, we will not explain the finite simple case
in any more detail, and instead we will restrict our arguments to semigroups
\emph{with} zero, apart from a brief excursion to Rees matrix semigroups in
Theorem \ref{thm:withoutzero}.  However, a future implementation of this theory
in GAP could be useful, and would be a logical extension of this project.

\subsection{Inverse semigroups: kernel-trace pairs}
\label{sec:kertr}

An inverse semigroup also has a structure which can be used in place of its
congruences: its \textit{kernel-trace pairs} (sometimes confusingly known as
``congruence pairs'').  Though these are not as useful computationally as linked
triples for completely simple and completely 0-simple semigroups, they can
certainly be used effectively to carry out calculations faster than by using
generating pairs in large cases.  A part of my previous thesis \cite[Chapter
5]{mtorpey_msc} focused on a computational use of kernel-trace pairs to solve
problems about congruences.

The basic theory about kernel-trace pairs is presented here, for reference.  In
all these definitions, $S$ is an inverse semigroup, $E$ is the set of
idempotents in $S$, and and $\rho$ is a congruence on $S$.  Recall that $E$ is a
subsemigroup of $S$.

\begin{definition}
  \label{def:kernel}
  The \textbf{kernel} of $\rho$ is $\bigcup_{e \in E} [e]_\rho$, the union of
  all the $\rho$-classes of $S$ which contain idempotents.  It is denoted by
  $\ker\rho$.\cite[p.155]{howie}
\end{definition}

\begin{definition}
  \label{def:trace}
  The \textbf{trace} of $\rho$ is $\rho \cap (E \times E)$, the restriction of
  $\rho$ to the idempotents of $S$.  It is denoted by $\tr\rho$.
  \cite[p.155]{howie}
\end{definition}

We will shortly see that a congruence on $S$ is completely defined by its kernel
and trace.  First we will approach kernel-trace pairs from an abstract route
which will help us to classify the congruences on $S$ completely.  We start with
two different definitions of the word ``normal'', one for subsemigroups and one
for congruences.

\begin{definition}
  \label{def:kernel-normal}
  A subsemigroup $K$ of $S$ is called \textbf{normal} if it is
  \textit{full} (contains all the idempotents of $S$) and
  \textit{self-conjugate} ($a^{-1}xa \in K$ for all $x \in K, a \in S$).
  \cite[p.155]{howie}
\end{definition}

\begin{definition}
  \label{def:trace-normal}
  A congruence $\tau$ on $E$ is \textbf{normal} in $S$ if
  $$(a^{-1}ea,a^{-1}fa) \in \tr \rho$$
  for every pair $(e,f) \in \tau$ and every element $a \in S$.
\end{definition}

Now we can define a \textit{kernel-trace pair}, an abstract structure which
relates very closely to a congruence.

\begin{definition}
  \label{def:kernel-trace-pair}
  A \textbf{kernel-trace pair} on $S$ is a pair $(K,\tau)$ consisting of a
  normal subsemigroup $K$ of $S$ and a normal congruence $\tau$ on $E$, such
  that
  \begin{enumerate}
  \item If $ae \in K$ and $(e,a^{-1}a) \in \tau$, then $a \in K$
  \item If $a \in K$, then $(aa^{-1},a^{-1}a) \in \tau$
  \end{enumerate}
  for all elements $a \in S$ and $e \in E$.
  \cite[p.156]{howie}
\end{definition}

Now we state the result which identifies an abstract kernel-trace pair with the
kernel and trace of a congruence, and allows us to calculate information about
$\rho$ by using $\ker \rho$ and $\tr \rho$ directly.

\begin{theorem}
  \label{thm:kernel-trace-pair}
  % Let $\rho$ be a congruence on an inverse semigroup $S$ with idempotent
  % semigroup $E$.  $(\ker\rho, \tr\rho)$ is a kernel-trace pair.

  % Conversely, every kernel-trace pair $(K,\tau)$ on $S$ defines a congruence
  % $$\rho_{(K,\tau)} = \{(x,y) \in S \times S ~|~ (x^{-1}x, y^{-1}y) \in \tau,
  % xy^{-1} \in K\}$$
  % whose kernel is equal to $K$ and whose trace is equal to $\tau$.  Finally,
  % $\rho_{(\ker\rho,\tr\rho)} = \rho$.
  Let $S$ be an inverse semigroup.  There exists a bijection $\Psi$ from the
  congruences on $S$ to the kernel-trace pairs on $S$, defined by
  $$\Psi: \rho \mapsto (\ker\rho, \tr\rho),$$
  whose inverse satisfies
  $$\Psi^{-1} : (K,\tau) \mapsto
  \{(x,y) \in S \times S ~|~ xy^{-1} \in K, (x^{-1}x, y^{-1}y) \in \tau\}.$$
\end{theorem}

This theorem tells us everything we need to know about kernel-trace pairs and
their relationship to congruences on an inverse semigroup.  Once we have the
kernel-trace pair of a congruence, we can solve any problem we wish to using the
kernel and trace alone, and computational problems are much faster than using
generating pairs directly \cite[\S 6.1.3]{mtorpey_msc}.  However, we may find
that if a congruence is specified initially using generating pairs, it may be
costly to find its kernel-trace pair in the first place; Section
\ref{sec:pairs-to-kertr} presents a clear improvement in this field.

\subsection{Rees congruences}
A \textbf{Rees congruence} is a congruence on a semigroup $S$ with a
distinguished congruence class $I$ which is a two-sided ideal of $S$, and in
which every other congruence class is a singleton.  We may write this congruence
as $\rho_I$, and we may write its quotient $S/\rho_I$ as $S/I$.  Hence, a pair
$(x,y)$ lies in $\rho_I$ if and only if $x=y$ or $x$ and $y$ both lie in $I$.

Some or all of a semigroup's congruences may be Rees: in particular, since $S$
is an ideal of $S$, the universal congruence $S \times S$ is a Rees congruence.
If $S$ has a zero $0$, then $\{0\}$ is an ideal and so the trivial congruence
$\Delta_S$ is a Rees congruence equal to $\rho_{\{0\}}$.

\subsection{Regular semigroups: something like kernel-trace?}

% TODO: put all these in one section
\section{A trivial example: linked triples and normal subgroups}

\section{Generating pairs of a Rees congruence}
\label{sec:rees-to-pairs}
A natural question, given an ideal $I$, is how to find a set of generating pairs
for $\rho_I$.

\begin{theorem}
  Let $S$ be a semigroup, $I$ an ideal of $S$, and $X$ an ideal generating set
  for $I$.  Also let $M$ be the minimal ideal of $S$ (which may or may not be
  equal to $I$).  Then $$X \times M$$ is a set of generating pairs for the Rees
  congruence $\rho_I$.
  \begin{proof}
    Let $\rho$ be the congruence generated by $X \times M$.  First we show that
    $\rho \subseteq \rho_I$, and then that $\rho_I \subseteq \rho$.

    Let $(i,m) \in X \times M$.  We have $X \subseteq I$ since $X$ is a
    generating set for $I$, and $M \subseteq I$ since $M$ is contained in any
    ideal of $S$.  Hence $i$ and $m$ both lie in $I$, so they are in the same
    class of the Rees congruence: $(i,m) \in \rho_I$.  Hence $X \times M
    \subseteq \rho_I$, and so $\rho$ (the least congruence containing $X \times
    M$) must also be contained in $\rho_I$.  Hence $\rho \subseteq \rho_I$.

    Now let $(a,b) \in \rho_I$; we wish to show that $(a,b) \in \rho$.  If $a=b$
    then we certainly have $(a,b) \in \rho$.  Otherwise we must have $a,b \in
    I$.  Since $X$ \textit{generates} $I$, we have $I = S^1XS^1$.  Therefore we
    can write
    $$a = s_1x_1t_1, \quad b = s_2x_2t_2,$$
    for some $x_1,x_2 \in X$ and $s_1,s_2,t_1,t_2 \in S^1$.

    Now choose some $m \in M$.  By definition $(x_1,m), (x_2,m) \in \rho$ since
    $X \times M \subseteq \rho$, and
    by the compatibility properties of a congruence,
    $$(s_1x_1t_1,s_1mt_1), (s_2x_2t_2,s_2mt_2) \in \rho.$$

    Since $m \in M$, we must have $s_1mt_1,s_2mt_2 \in M$.  Let $x_0$ be an
    arbitrary element of $X$.
    We see $(x_0,s_1mt_1), (x_0,s_2mt_2) \in X \times M$, and so by transitivity
    $(s_1mt_1, s_2mt_2) \in \rho$.
    Hence
    $$a ~=~ s_1x_1t_1 ~\rho~ s_1mt_1 ~\rho~ s_2mt_2 ~\rho~ s_2x_2t_2 = b,$$
    and $(a,b) \in \rho$ as required.
  \end{proof}
\end{theorem}

\section{Kernel and trace from generating pairs}
\label{sec:pairs-to-kertr}

Given a set of generating pairs $\mathbf{R}$ over a semigroup $S$, we may wish
to consider the congruence $\rho = \mathbf{R}^\sharp$ and ask questions such as
whether a pair lies in the congruence, or the number of congruence classes.
This is certainly possible by various methods, for example the variety of
algorithms mentioned in Chapter \ref{chap:pairs}---however, if $S$ is an inverse
semigroup then any calculation we wish to carry out will be much faster if we
know the congruence's kernel-trace pair, as described in Section
\ref{sec:kertr}.  We therefore wish for a fast way of determining the kernel and
trace of $\rho$.

One way of calculating the kernel and trace would be simply to enumerate all the
elements in all the classes of $\rho$, and to search for the idempotents to
compute the kernel and trace.  However, enumerating all the classes is very
time-consuming, and the main reason to calculate the kernel-trace pair in the
first place is probably to avoid this work.  Hence, we want to find the
kernel-trace pair directly from the generating pairs $\mathbf{R}$, enumerating
as few pairs in $\mathbf{R}^\sharp$ as possible.

A new way of finding the kernel and trace directly from the generating pairs is
presented in Algorithm \ref{alg:pairs-to-kertr}.

TODO: explain Algorithm \ref{alg:pairs-to-kertr} and justify it.

\begin{algorithm}
\caption{The kernel-trace pair of a congruence by generating pairs}
\label{alg:pairs-to-kertr}
\begin{algorithmic}[1]
\Require $S$ an inverse semigroup with idempotents $E$
\Require $\mathbf{R} \subseteq S \times S$
\Procedure{KerTraceFromGenPairs}{$\mathbf{R}$}
\State $K := E$
\State $\tau := \Delta_E$
\State Let $S'$ be a generating set for $S$
\State Let $E'$ be a generating set for $E$
\State $X \gets E' \cup \{ab^{-1} : (a,b) \in \mathbf{R}\}$
\State $\mathbf{T} \gets \{(a^{-1}a, b^{-1}b) : (a,b) \in \mathbf{R}\}$
\State $\tau \gets (\tau \cup T)^e$
\Repeat
\State $\delta \gets \False$ \Comment{Nothing has changed yet}
\State \Call{EnumerateKernel}{ }
\State \Call{EnforceConditions}{ }
\State \Call{EnumerateTrace}{ }
\Until{$\delta = \False$} \Comment{Exit loop if nothing changed}
\State \Return $(K, \tau)$
\EndProcedure

\Procedure{EnumerateKernel}{ }
\If{$X \setminus K \neq \varnothing$}
  \State $K \gets \llangle K, X \rrangle$
  \State $\delta \gets \True$
\EndIf
\State $X \gets \varnothing$
\EndProcedure

\Procedure{EnforceConditions}{ }
\For{$a \in S$}
  \If{$a \in K$}
    \If{$(aa^{-1}, a^{-1}a) \notin \tau$}
      \State $\mathbf{T} \gets \mathbf{T} \cup \{(aa^{-1}, a^{-1}a)\}$
      \State $\delta \gets \True$
    \EndIf
  \Else
    \For{$e \in [a^{-1}a]_\tau$}
      \If{$ae \in K$}
        \State $X \gets X \cup \{a\}$
        \State $\delta \gets \True$
      \EndIf
    \EndFor
  \EndIf
\EndFor
\EndProcedure

\Procedure{EnumerateTrace}{ }
\While{$\mathbf{T} \neq \varnothing$}
  \State Pick any $(x,y) \in \mathbf{T}$
  \For{$e \in E'$}
    \If{$(xe, ye) \notin \tau$}
      \State $\delta \gets \True$
      \State $T \gets T \cup \{(xe, ye)\}$
      \State $\tau \gets (\tau \cup \{(xe, ye)\})^e$
      \For{$a \in S'$}
        % TODO: should this be a^-1 xe a?
        \If{$(a^{-1}xa, a^{-1}ya) \notin \tau$}
          \State $T \gets T \cup \{(a^{-1}xa, a^{-1}ya)\}$
          \State $\tau \gets (\tau \cup \{(a^{-1}xa, a^{-1}ya)\})^e$
        \EndIf
      \EndFor
    \EndIf
  \EndFor
  \State $\mathbf{T} \gets \mathbf{T} \setminus \{(x,y)\}$
\EndWhile
\EndProcedure
\end{algorithmic}
\end{algorithm}

% kernelgenstoapply = $X$
% pairstoapply = $\mathbf{T}$
% traceBlocks/traceUF = $\tau$

\section{Generating pairs from kernel and trace}
\label{sec:kertr-to-pairs}

\section{Things to add to this chapter}
\begin{enumerate}
\item Regular semigroups? (might not be the same sort of thing)
\end{enumerate}
