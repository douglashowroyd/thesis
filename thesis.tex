\documentclass[a4paper]{report}

% Packages
\usepackage[nodisplayskipstretch]{setspace} % must be before algorithm & float
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{aliascnt}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{array}
\usepackage[nottoc]{tocbibind}
\usepackage{cancel}
\usepackage{colortbl}
\usepackage{dot2texi}
\usepackage{draftwatermark}
\usepackage{enumerate}
\usepackage{float}
\usepackage{forest}
\usepackage[hidelinks]{hyperref}
\usepackage[iso, UKenglish]{isodate}
\usepackage{lipsum}
\usepackage{longtable}
\usepackage{makeidx}
\usepackage{mathdots}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{pifont}
\usepackage{pstricks}
\usepackage{svg}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{url}
\usepackage{xcolor}
\usepackage{xfrac}

% Compile the index
\makeindex

% Automatic bracket sizing
%\usepackage{nath}
%\delimgrowth=1
\delimitershortfall=-1pt

% Other library imports
\usetikzlibrary{arrows,shapes}
\forestset{uf/.style={for tree={edge={<-}}}}

% Algorithmic
\algnewcommand\algorithmicbreak{\textbf{break}}
\algnewcommand\Break{\algorithmicbreak{} }

% Hyperlink references (invisible)
%\hypersetup{linkcolor=black, urlcolor=black, citecolor=black}

% Fix double spacing in arrays
\setlength{\jot}{-1ex}
\renewcommand*\arraystretch{.7}

% Watermark with git hash
\immediate\write18{git rev-parse --short HEAD > hash.info}
\immediate\write18{git diff --shortstat > changes.info}
\immediate\write18{git diff --staged --shortstat >> changes.info}
\SetWatermarkText{Commit \input{hash.info} \quad \input{changes.info}}
\SetWatermarkColor[gray]{0.75}
\SetWatermarkFontSize{0.5cm}
\SetWatermarkAngle{90}
\SetWatermarkHorCenter{3cm}

% Macros
\input{macros}

% Object numbering
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{method}[theorem]{Method}

\newcounter{common}[chapter]
\makeatletter
\let\c@algorithm\relax
\let\c@figure\relax
\let\c@table\relax
\let\c@theorem\relax
\makeatother
\newaliascnt{algorithm}{common}
\newaliascnt{figure}{common}
\newaliascnt{table}{common}
\newaliascnt{theorem}{common}
\renewcommand{\thealgorithm}{\thechapter.\arabic{algorithm}}
\renewcommand{\thefigure}{\thechapter.\arabic{figure}}
\renewcommand{\thetable}{\thechapter.\arabic{table}}
\renewcommand{\thetheorem}{\thechapter.\arabic{theorem}}

% Sequential page numbering
\let\oldsetcounter=\setcounter
\renewcommand\setcounter[2]{%
    \def\arg{#1}\def\pg{page}%
    \ifx\arg\pg\else\oldsetcounter{#1}{#2}\fi}

% TODO: Actual title
\title{My PhD Thesis}
\author{Michael Torpey}

\begin{document}

\maketitle

\doublespacing

\include{abstract}

\singlespacing
\tableofcontents
\doublespacing

\include{intro}

\part{Algorithms}
\label{part:algorithms}
\include{ch-pairs}
\include{ch-lattice}
\include{ch-converting}

\part{Results}
\label{part:results}
\include{ch-nrcongs}
\include{ch-princfact}
\include{ch-pn}

\bibliography{bibliography}
\bibliographystyle{alpha}

\singlespacing
\listofalgorithms
\addcontentsline{toc}{chapter}{\listalgorithmname}
\clearpage
\phantomsection
\printindex
\doublespacing

\end{document}
